KISSY.add("magix/body",function(j,b,u){var w=b.has,i=b.listToMap("submit,focusin,focusout,mouseenter,mouseleave,mousewheel,change"),g=document.body,m={},t={},o=65536,q=function(b,c,l){l?b.setAttribute(c,l):l=b.getAttribute(c);return l},r,p={process:function(b){for(var c=b.target||b.srcElement;c&&1!=c.nodeType;)c=c.parentNode;var l=c,n=b.type,i=t[n]||(t[n]=RegExp("(?:^|,)"+n+"(?:,|$)"));if(!i.test(q(c,"mx-ie"))){for(var m="mx-"+n,d,k,a=[];l&&l!=g&&!(d=q(l,m),k=q(l,"mx-ie"),d||i.test(k));)a.push(l),
l=l.parentNode;if(d){n=q(l,"mx-owner");if(!n){i=l;for(k=r.all();i&&i!=g;)if(w(k,i.id)){q(l,"mx-owner",n=i.id);break}else i=i.parentNode}if(n)(n=(n=r.get(n))&&n.view)&&n.processEvent({info:d,se:b,tId:c.id||(c.id="mx-e-"+o--),cId:l.id||(l.id="mx-e-"+o--)});else throw Error("miss mx-owner:"+d);}else for(;a.length;)b=a.shift(),k=q(b,"mx-ie"),i.test(k)||(k=k?k+","+n:n,q(b,"mx-ie",k))}},on:function(b,c){var l=this;m[b]?m[b]++:(r=c,m[b]=1,i[b]?l.unbubble(0,g,b):g["on"+b]=function(b){(b=b||window.event)&&
l.process(b)})},un:function(b){var c=m[b];0<c&&(c--,c||(i[b]?this.unbubble(1,g,b):g["on"+b]=null),m[b]=c)}};p.unbubble=function(b,c,l){(b?u.undelegate:u.delegate).call(u,c,l,"[mx-"+l+"]",p.process)};return p},{requires:["magix/magix","event","sizzle"]});
KISSY.add("magix/event",function(j,b){var u=b.safeExec;return{fire:function(b,i,g,m){var t="~"+b,o=this[t];if(o){i||(i={});if(!i.type)i.type=b;for(var b=o.length,q=b-1,r,p;b--;){r=m?b:q-b;p=o[r];if(p.d||p.r)o.splice(r,1),q--;p.d||u(p.f,i,this)}}g&&delete this[t]},on:function(j,i,g){j="~"+j;j=this[j]||(this[j]=[]);b.isNumeric(g)?j.splice(g,0,{f:i}):j.push({f:i,r:g})},un:function(b,i){var g="~"+b,m=this[g];if(m)if(i)for(var g=m.length-1,j;0<=g;g--){if(j=m[g],j.f==i&&!j.d){j.d=1;break}}else delete this[g]}}},
{requires:["magix/magix"]});
KISSY.add("magix/magix",function(j){var b=[].slice,u=/\/\.\/|\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,w=/\/[^\/]*$/,i=/[#?].*$/,g=/([^=&?\/#]+)=([^&=#?]*)/g,m=/^https?:\/\//i,t={},o=0,q={debug:false,iniFile:"app/ini",appName:"app",appHome:"./",tagName:"vframe",rootId:"magix_vf_root"},r=t.hasOwnProperty,p=function(a){return function(B,b,f){switch(arguments.length){case 0:f=a;break;case 1:f=k.isObject(B)?n(a,B):l(a,B)?a[B]:null;break;case 2:null===b?(delete a[B],f=b):a[B]=f=b}return f}},s=function(a){this.c=
[];this.x=a||5;this.b=this.x+3},c=function(a){return new s(a)},l=function(a,b){return a?r.call(a,b):0},n=function(a,b,e){for(var f in b)if(!e||!l(e,f))a[f]=b[f];return a};n(s.prototype,{get:function(a){var b=this.c,e,a="pathname"+a;if(l(b,a)&&(e=b[a],1<=e.f))e.f++,e.t=o++,e=e.v;return e},set:function(a,b){var e=this.c,a="pathname"+a,f=e[a];if(!l(e,a)){if(e.length>=this.b){e.sort(function(a,b){return b.f==a.f?b.t-a.t:b.f-a.f});for(var d=this.b-this.x;d--;)f=e.pop(),delete e[f.k]}f={};e.push(f);e[a]=
f}f.k=a;f.v=b;f.f=1;f.t=o++;return f},del:function(a){var a="pathname"+a,b=this.c,e=b[a];if(e)e.f=-1E5,e.v="",delete b[a]},has:function(a){return l(this.c,"pathname"+a)}});var z=c(20),x=c(),d=function(a,b,e,f,d,h){k.isArray(a)||(a=[a]);if(!b||!k.isArray(b)&&!b.callee)b=[b];for(f=0;f<a.length;f++)try{h=a[f],d=k.isFunction(h)&&h.apply(e,b)}catch(c){}return d},k={isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},mix:n,has:l,safeExec:d,noop:function(){},config:p(q),start:function(a){var b=
this,a=n(q,a);b.libEnv(a);b.libRequire(a.iniFile,function(e){q=n(a,e,a);q.tagNameChanged="vframe"!=q.tagName;var f=a.progress;b.libRequire(["magix/router","magix/vom"],function(e,h){e.on("!ul",h.locChged);e.on("changed",h.locChged);f&&h.on("progress",f);b.libRequire(a.extensions,e.start)})});a.ready&&(d(a.ready),delete a.ready)},keys:Object.keys||function(a){var b=[],e;for(e in a)l(a,e)&&b.push(e);return b},local:p({}),path:function(a,b){var e=a+"\n"+b,f=x.get(e);if(!f){m.test(b)?f=b:(a=a.replace(i,
"").replace(w,"")+"/","/"==b.charAt(0)?(f=m.test(a)?8:0,f=a.indexOf("/",f),f=a.substring(0,f)+b):f=a+b);for(;u.test(f);)f=f.replace(u,"$1/");x.set(e,f)}return f},pathToObject:function(a,b){var e=z.get(a);if(!e){var e={},f={},d="";i.test(a)?d=a.replace(i,""):~a.indexOf("=")||(d=a);if(d&&m.test(d))var h=d.indexOf("/",8),d=-1==h?"/":d.substring(h);a.replace(g,function(a,h,e){if(b)try{e=decodeURIComponent(e)}catch(D){}f[h]=e});e.pathname=d;e.params=f;z.set(a,e)}return e},objectToPath:function(a,b){var e=
a.pathname,d=[],c=a.params,h,k;for(k in c)h=c[k],b&&encodeURIComponent(h),d.push(k+"="+h);return e+(e&&d.length?"?":"")+d.join("&")},tmpl:function(a,b){return 1==arguments.length?{v:t[a],h:l(t,a)}:t[a]=b},listToMap:function(a,b){var e,d,c={},h;k.isString(a)&&(a=a.split(","));if(a&&(h=a.length))for(e=0;e<h;e++)d=a[e],c[b?d[b]:d]=b?d:1;return c},cache:c};return n(k,{libRequire:function(a,d){a?j.use(""+a,function(a){d&&d.apply(a,b.call(arguments,1))}):d&&d()},libEnv:function(a){var b=a.appHome,d=location,
c=a.appName,b=this.path(d.href,b+"/");a.appHome=b;var k=a.debug;k&&(k=0==b.indexOf(d.protocol+"//"+d.host+"/"));d="";(d=k?j.now():a.appTag)&&(d+=".js");j.config({packages:[{name:c,path:b,debug:a.debug=k,combine:a.appCombine,tag:d}]})},isArray:j.isArray,isFunction:j.isFunction,isObject:j.isObject,isRegExp:j.isRegExp,isString:j.isString,isNumber:j.isNumber})});
KISSY.add("magix/router",function(j,b,u,w){var i=window,g=b.has,m=b.mix,j=document,t=/^UTF-8$/i.test(j.charset||j.characterSet||"UTF-8"),o=b.config(),q=b.cache(),r=b.cache(),p,s,c,l=/#.*$/,n=/^[^#]*#?!?/,z=o.nativeHistory,x,d,k=function(a,h,d){if(a){d=this.params;b.isArray(a)||(a=a.split(","));for(var e=0;e<a.length&&!(h=g(d,a[e]));e++);}return h},a=function(){return g(this,"pathname")},B=function(){return g(this,"view")},e=function(){return this.hash.pathname!=this.query.pathname},f=function(a){return this.hash.params[a]!=
this.query.params[a]},C=function(a){return g(this.hash.params,a)},h=function(a){return g(this.query.params,a)},A=function(a){return this.params[a]},y=function(a){var a=b.pathToObject(a,t),h=a.pathname;h&&d&&(a.pathname=b.path(i.location.pathname,h));return a},v=m({getView:function(a){if(!c){c={rs:o.routes||{},nf:o.notFoundView};var h=o.defaultView;if(!h)throw Error("unset defaultView");c.home=h;var d=o.defaultPathname||"";c.rs[d]=h;c.pathname=d}a||(a=c.pathname);h=c.rs;h=b.isFunction(h)?h.call(o,
a):h[a];return{view:h?h:c.nf||c.home,pathname:h?a:c.nf?a:c.pathname}},start:function(){var a=v,b=i.history;x=z&&b.pushState;d=z&&!x;x?a.useState():a.useHash();a.route()},parseQH:function(a){var a=a||i.location.href,b=v,d=q.get(a);if(!d){var d=a.replace(l,""),c=a.replace(n,""),k=y(d),g=y(c),j={};m(j,k.params);m(j,g.params);d={pathnameDiff:e,paramDiff:f,hashOwn:C,queryOwn:h,get:A,href:a,srcQuery:d,srcHash:c,query:k,hash:g,params:j};q.set(a,d)}d.view||(a=b.getView(z?d.hash.pathname||d.query.pathname:
d.hash.pathname),m(d,a));return d},getChged:function(b,h){var d=h.href,e=b.href+"\n"+d,c=r.get(e);c||(e=d+"\n"+e,c=r.get(e));if(!c){var f,c={params:{}};if(b.pathname!=h.pathname)f=c.pathname=1;if(b.view!=h.view)f=c.view=1;var d=b.params,A=h.params,v;for(v in d)d[v]!=A[v]&&(f=1,c.params[v]=1);for(v in A)d[v]!=A[v]&&(f=1,c.params[v]=1);c.occur=f;c.isParam=k;c.isPathname=a;c.isView=B;r.set(e,c)}return c},route:function(){var a=v,b=a.parseQH(),h=s||{params:{},href:"~"},d=!s;s=b;h=a.getChged(h,b);h.occur&&
(p=b,a.fire("changed",{location:b,changed:h,force:d}))},navigate:function(a,h,c){var e=v;!h&&b.isObject(a)&&(h=a,a="");h&&(a=b.objectToPath({params:h,pathname:a},t));if(a){h=y(a);a={};a.params=m({},h.params);a.pathname=h.pathname;if(a.pathname){if(d&&(h=p.query)&&(h=h.params))for(var k in h)g(h,k)&&!g(a.params,k)&&(a.params[k]="")}else k=m({},p.params),a.params=m(k,a.params),a.pathname=p.pathname;k=b.objectToPath(a);if(x?k!=p.srcQuery:k!=p.srcHash)x?(e.poped=1,history[c?"replaceState":"pushState"](null,
null,k),e.route()):(m(a,p,a),a.srcHash=k,a.hash={params:a.params,pathname:a.pathname},e.fire("!ul",{loc:p=a}),k="#!"+k,c?location.replace(k):location.hash=k)}}},u);v.useState=function(){var a=v,h=location.href;w.on(i,"popstate",function(){var b=location.href==h;if(a.poped||!b)a.poped=1,a.route()})};v.useHash=function(){w.on(i,"hashchange",v.route)};return v},{requires:["magix/magix","magix/event","event"]});
KISSY.add("magix/vframe",function(j,b,u,w){var i=document,g=65536,m=b.mix,t=b.config("tagName"),o=b.config("rootId"),q=!b.config("tagNameChanged"),r=b.has,p=q?"mx-defer":"mx-vframe",s,c,l=function(b){return"object"==typeof b?b:i.getElementById(b)},n=/<script[^>]*>[\s\S]*?<\/script>/ig,z,x=function(b){this.id=b;this.cM={};this.rC=this.cC=0;this.sign=-2147483648;this.rM={}};m(x,{root:function(b,c){if(!s){z=c;var a=l(o);if(!a)a=i.createElement(t),a.id=o,i.body.insertBefore(a,i.body.firstChild);s=new x(o);
b.add(s)}return s}});m(m(x.prototype,u),{mountView:function(d,c){var a=this,g=l(a.id);g._bak?g._chgd=1:(g._bak=1,g._tmpl=g.innerHTML.replace(n,""));a.unmountView();if(d){var e=b.pathToObject(d),f=e.pathname,i=--a.sign;b.libRequire(f,function(b){if(i==a.sign){var d=a.owner;w.prepare(b);var y=new b({owner:a,id:a.id,$:l,path:f,vom:d,location:z});a.view=y;y.on("interact",function(b){if(!b.tmpl){if(g._chgd)g.innerHTML=g._tmpl;a.mountZoneVframes(0,0,1)}y.on("rendered",function(){a.mountZoneVframes(0,0,
1)});y.on("prerender",function(){a.unmountZoneVframes()});y.on("inited",function(){a.viewInited=1;a.fire("viewInited",{view:y})})},0);c=c||{};y.load(m(c,e.params,c))}})}},unmountView:function(){if(this.view){c||(c={caused:this.id});this.unmountZoneVframes();this.cAlter(c);this.view.destroy();var b=l(this.id);if(b&&b._bak)b.innerHTML=b._tmpl;delete this.view;delete this.viewInited;c=0;this.fire("viewUnmounted")}this.un("viewInited");this.sign--},mountVframe:function(b,c,a,g){var e=this.owner,f=e.get(b);
if(!f)f=new x(b),f.pId=this.id,r(this.cM,b)||this.cC++,this.cM[b]=g,e.add(f);f.mountView(c,a);return f},mountZoneVframes:function(b,c,a){this.unmountZoneVframes(b);var b=l(b||this.id).getElementsByTagName(t),i=b.length,e={};if(i)for(var f=0,j,h,A,y;f<i;f++)if(j=b[f],h=j.id||(j.id="magix_vf_"+g--),!r(e,h)&&(A=j.getAttribute("mx-view"),(y=!j.getAttribute(p)==q)||A)){this.mountVframe(h,A,c,a);h=l(j).getElementsByTagName(t);for(var v=0,m=h.length,n;v<m;v++)n=h[v],A=n.getAttribute("mx-view"),y=!j.getAttribute(p)==
q,!y&&!A&&(e[n.id||(n.id="magix_vf_"+g--)]=1)}this.cC==this.rC&&this.cCreated({})},unmountVframe:function(b){var b=b||this.id,c=this.owner,a=c.get(b);if(a){var g=a.fcc;a.unmountView();c.remove(b,g);if((c=c.get(a.pId))&&r(c.cM,b))delete c.cM[b],c.cC--}},unmountZoneVframes:function(b){if(b){for(var b=l(b).getElementsByTagName(t),c={},a=this.cM,g=b.length-1,e;0<=g;g--)e=b[g].id,r(a,e)&&(c[e]=1);b=c}else b=this.cM;for(var f in b)this.unmountVframe(f)},cCreated:function(b){var c=this.view;if(c&&!this.fcc)this.fcc=
1,delete this.fca,c.fire("created",b),this.fire("created",b);var a=this.owner;a.vfCreated();c=this.id;if((a=a.get(this.pId))&&!r(a.rM,c))a.rM[c]=a.cM[c],a.rC++,a.rC==a.cC&&a.cCreated(b)},cAlter:function(b){delete this.fcc;if(!this.fca){var c=this.view,a=this.id;if(c)this.fca=1,c.fire("alter",b),this.fire("alter",b);if((c=this.owner.get(this.pId))&&r(c.rM,a)){var g=c.rM[a];c.rC--;delete c.rM[a];g&&c.cAlter(b)}}},locChged:function(c,g){var a=this.view;if(a&&a.sign&&a.rendered){var i=a.olChanged(g),
e={location:c,changed:g,prevent:function(){this.cs=[]},toChildren:function(a){a=a||[];b.isString(a)&&(a=a.split(","));this.cs=a}};i&&b.safeExec(a.locationChange,e,a);for(var a=e.cs||b.keys(this.cM),i=0,e=a.length,f=this.owner,j;i<e;i++)(j=f.get(a[i]))&&j.locChged(c,g)}}});return x},{requires:["magix/magix","magix/event","magix/view"]});
KISSY.add("magix/view",function(j,b,u,w,i){var g=b.safeExec,m=b.has,t=[],o=b.mix,q=["render","renderUI"],r=function(a){return function(){var b;this.notifyUpdate()&&(b=a.apply(this,arguments));return b}},p=b.cache(40),s=function(a){o(this,a);this.sign=1};o(s,{wrapUpdate:function(){if(!this["~"]){this["~"]=1;for(var a=this.prototype,c,e=q.length-1,d;-1<e;e--)d=q[e],c=a[d],b.isFunction(c)&&c!=b.noop&&(a[d]=r(c))}}});var c=s.prototype,l=window.CollectGarbage||b.noop,n=/<[a-z]+(?:[^">]|"[^"]*")+(?=>)/g,
z=/\smx-owner\s*=/,x=/\smx-[^v][a-z]+\s*=/,d=function(a){return!z.test(a)&&x.test(a)?a+' mx-owner="'+d.t+'"':a},k={prevent:function(a){a=a||this.domEvent;a.preventDefault?a.preventDefault():a.returnValue=!1},stop:function(a){a=a||this.domEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},halt:function(a){this.prevent(a);this.stop(a)}},a=/(\w+)(?:<(\w+)>)?(?:{([\s\S]*)})?/,B=/(\w+):([^,]+)/g;o(c,u);o(c,{render:b.noop,locationChange:b.noop,init:b.noop,hasTmpl:!0,enableEvent:!0,load:function(){var a=
this,b=a.hasTmpl,c=arguments,e=a.sign,d=m(a,"template"),f=function(f){if(e==a.sign){if(!d)a.template=a.wrapMxEvent(f);a.delegateEvents();a.fire("interact",{tmpl:b},1);g(a.init,c,a);a.fire("inited",0,1);g(a.render,t,a);if(!b&&!a.rendered)a.rendered=!0,a.fire("primed",null,1)}};b&&!d?a.fetchTmpl(f):f()},beginUpdate:function(){this.sign&&this.rendered&&(this.fire("refresh",0,1),this.fire("prerender"))},endUpdate:function(){if(this.sign)this.rendered||this.fire("primed",0,1),this.rendered=!0,this.fire("rendered"),
l()},notifyUpdate:function(){this.sign&&(this.sign++,this.fire("rendercall"));return this.sign},wrapMxEvent:function(a){d.t=this.id;return(""+a).replace(n,d)},setViewHTML:function(a){var b;this.beginUpdate();if(this.sign&&(b=this.$(this.id)))b.innerHTML=a;this.endUpdate()},observeLocation:function(a){var c;if(!this.$ol)this.$ol={keys:[]};c=this.$ol;var e=c.keys;if(b.isObject(a))c.pn=a.pathname,a=a.keys;if(a)c.keys=e.concat((""+a).split(","))},olChanged:function(a){var b=this.$ol;if(b){var c=0;b.pn&&
(c=a.isPathname());c||(c=a.isParam(b.keys));return c}return 1},destroy:function(){this.fire("refresh",0,1);this.fire("destroy",0,1,1);this.delegateEvents(1);this.sign=0},parentView:function(){var a=this.vom.get(this.owner.pId),b=null;if(a&&a.viewInited)b=a.view;return b},processEvent:function(b){if(this.enableEvent&&this.sign){var c=b.info,e=b.se,d=p.get(c);d||(d=c.match(a),d={n:d[1],f:d[2],i:d[3],p:{}},d.i&&d.i.replace(B,function(a,b,c){d.p[b]=c}),p.set(c,d));if(c=this.events){var f=c[e.type],i=
k[d.f];i&&i.call(k,e);(i=f&&f[d.n])&&g(i,o({view:this,currentId:b.cId,targetId:b.tId,domEvent:e,events:c,params:d.p},k),f)}}},delegateEvents:function(a){var b=this.events,a=a?w.un:w.on,c=this.vom,d;for(d in b)a.call(w,d,c)}});var e=b.config("appHome"),f=b.config("debug")?"?t="+j.now():"",C=function(a,b,c){for(var d in b)j.isObject(b[d])?(m(a,d)||(a[d]={}),C(a[d],b[d],1)):c&&(a[d]=b[d])};s.prototype.fetchTmpl=function(a){var c=this,d=c.template;if(j.isUndefined(d))if(d=b.tmpl(c.path),d.h)a(d.v);else{var l=
e+c.path+".html",k=C[l],d=function(d){a(b.tmpl(c.path,d))};k?k.push(d):(k=C[l]=[d],i({url:l+f,success:function(a){g(k,a);delete C[l]},error:function(a,b){g(k,b);delete C[l]}}))}else a(d)};s.extend=function(a,b,c){var d=function(){d.superclass.constructor.apply(this,arguments);b&&g(b,arguments,this)};d.extend=this.extend;return j.extend(d,this,a,c)};s.prepare=function(a){if(!a.wrapUpdate){a.wrapUpdate=this.wrapUpdate;a.extend=this.extend;for(var b=a.prototype,c=a.superclass;c;)c=c.constructor,C(b,
c.prototype),c=c.superclass}a.wrapUpdate()};return s},{requires:["magix/magix","magix/event","magix/body","ajax"]});
KISSY.add("magix/vom",function(j,b,u,w){var i=u.has,g=u.mix,m=0,t=0,o=0,q=0,r={},p={},s=u.mix({all:function(){return r},add:function(b){if(!i(r,b.id))m++,r[b.id]=b,b.owner=s,s.fire("add",{vframe:b})},get:function(b){return r[b]},remove:function(b,g){var i=r[b];i&&(m--,g&&t--,delete r[b],s.fire("remove",{vframe:i}))},vfCreated:function(){if(!q){t++;var b=t/m;o<b&&s.fire("progress",{percent:o=b},q=1==b)}},root:function(){return b.root(s,p)},locChged:function(b){var i=b.loc,j;i?j=1:i=b.location;g(p,
i);if(!j)j=s.root(),b=b.changed,b.isView()?j.mountView(i.view):j.locChged(i,b)}},w);return s},{requires:["magix/vframe","magix/magix","magix/event"]});(function(j){var b=function(){};if(!j.console)j.console={log:b,info:b,error:b};var u,w={};if(!j.Magix)j.Magix={config:function(b){for(var g in b)w[g]=b[g]},start:function(b){u=b}},KISSY.use("magix/magix",function(b,g){j.Magix=g;g.config(w);u&&g.start(u)})})(this);