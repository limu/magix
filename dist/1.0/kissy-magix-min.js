KISSY.add("magix/body",function(h,a,u){var x=a.has,f=a.listToMap("submit,focusin,focusout,mouseenter,mouseleave,mousewheel,change"),i=document.body,q={},p={},v=65536,l=function(a,d,e){e?a.setAttribute(d,e):e=a.getAttribute(d);return e},r,t={process:function(a){for(var d=a.target||a.srcElement;d&&1!=d.nodeType;)d=d.parentNode;var e=d,j=a.type,f=p[j]||(p[j]=RegExp("(?:^|,)"+j+"(?:,|$)"));if(!f.test(l(d,"mx-ie"))){for(var k="mx-"+j,o,c,b=[];e&&e!=i&&!(o=l(e,k),c=l(e,"mx-ie"),o||f.test(c));)b.push(e),
e=e.parentNode;if(o){j=l(e,"mx-owner");if(!j){f=e;for(c=r.all();f&&f!=i;)if(x(c,f.id)){l(e,"mx-owner",j=f.id);break}else f=f.parentNode}if(j)(j=(j=r.get(j))&&j.view)&&j.processEvent({info:o,se:a,tId:d.id||(d.id="mx-e-"+v--),cId:e.id||(e.id="mx-e-"+v--)});else throw Error("miss mx-owner:"+o);}else for(;b.length;)a=b.shift(),c=l(a,"mx-ie"),f.test(c)||(c=c?c+","+j:j,l(a,"mx-ie",c))}},on:function(a,d){var e=this;q[a]?q[a]++:(r=d,q[a]=1,f[a]?e.unbubble(0,i,a):i["on"+a]=function(a){(a=a||window.event)&&
e.process(a)})},un:function(a){var d=q[a];0<d&&(d--,d||(f[a]?this.unbubble(1,i,a):i["on"+a]=null),q[a]=d)}};t.unbubble=function(a,d,e){(a?u.undelegate:u.delegate).call(u,d,e,"[mx-"+e+"]",t.process)};return t},{requires:["magix/magix","event","sizzle"]});
KISSY.add("magix/event",function(h,a){var u=a.safeExec;return{fire:function(a,f,i,q){var p="~"+a,h=this[p];if(h){f||(f={});if(!f.type)f.type=a;for(var a=h.length,l=a-1,r,t;a--;){r=q?a:l-a;t=h[r];if(t.d||t.r)h.splice(r,1),l--;t.d||u(t.f,f,this)}}i&&delete this[p]},on:function(h,f,i){h="~"+h;h=this[h]||(this[h]=[]);a.isNumeric(i)?h.splice(i,0,{f:f}):h.push({f:f,r:i})},un:function(a,f){var i="~"+a,h=this[i];if(h)if(f)for(var i=h.length-1,p;0<=i;i--){if(p=h[i],p.f==f&&!p.d){p.d=1;break}}else delete this[i]}}},
{requires:["magix/magix"]});
KISSY.add("magix/magix",function(h){var a=[].slice,u=/\/\.\/|\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,x=/\/[^\/]*$/,f=/[#?].*$/,i=/([^=&?\/#]+)=([^&=#?]*)/g,q=/^https?:\/\//i,p={},v=0,l={debug:false,iniFile:"app/ini",appName:"app",appHome:"./",tagName:"vframe",rootId:"magix_vf_root"},r=p.hasOwnProperty,t=function(b){return function(a,m,w){switch(arguments.length){case 0:w=b;break;case 1:w=c.isObject(a)?j(b,a):e(b,a)?b[a]:null;break;case 2:null===m?(delete b[a],w=m):b[a]=w=m}return w}},s=function(b){this.c=
[];this.x=b||20;this.b=this.x+5},d=function(b){return new s(b)},e=function(b,a){return b?r.call(b,a):0},j=function(b,a,m){for(var c in a)if(!m||!e(m,c))b[c]=a[c];return b};j(s.prototype,{get:function(b){var a=this.c,m,b="pathname"+b;if(e(a,b)&&(m=a[b],1<=m.f))m.f++,m.t=v++,m=m.v;return m},set:function(b,a){var m=this.c,b="pathname"+b,c=m[b];if(!e(m,b)){if(m.length>=this.b){m.sort(function(g,b){return b.f==g.f?b.t-g.t:b.f-g.f});for(var g=this.b-this.x;g--;)c=m.pop(),delete m[c.k]}c={};m.push(c);m[b]=
c}c.k=b;c.v=a;c.f=1;c.t=v++;return c},del:function(b){var b="pathname"+b,a=this.c,c=a[b];if(c)c.f=-1E5,c.v="",delete a[b]},has:function(b){return e(this.c,"pathname"+b)}});var y=d(60),k=d(),o=function(b,a,m,w,g,n){c.isArray(b)||(b=[b]);if(!a||!c.isArray(a)&&!a.callee)a=[a];for(w=0;w<b.length;w++)try{n=b[w],g=c.isFunction(n)&&n.apply(m,a)}catch(d){}return g},c={isNumeric:function(b){return!isNaN(parseFloat(b))&&isFinite(b)},mix:j,has:e,safeExec:o,noop:function(){},config:t(l),start:function(b){var a=
this,b=j(l,b);a.libEnv(b);a.libRequire(b.iniFile,function(c){l=j(b,c,b);var d=b.progress;a.libRequire(["magix/router","magix/vom"],function(g,c){g.on("!ul",c.locChged);g.on("changed",c.locChged);d&&c.on("progress",d);a.libRequire(b.extensions,g.start)})});b.ready&&(o(b.ready),delete b.ready)},keys:Object.keys||function(b){var a=[],c;for(c in b)e(b,c)&&a.push(c);return a},local:t({}),path:function(b,a){var c=b+"\n"+a,d=k.get(c);if(!d){q.test(a)?d=a:(b=b.replace(f,"").replace(x,"")+"/","/"==a.charAt(0)?
(d=q.test(b)?8:0,d=b.indexOf("/",d),d=b.substring(0,d)+a):d=b+a);for(;u.test(d);)d=d.replace(u,"$1/");k.set(c,d)}return d},pathToObject:function(b,a){var c=y.get(b);if(!c){var c={},d={},g="";f.test(b)?g=b.replace(f,""):~b.indexOf("=")||(g=b);if(g&&q.test(g))var n=g.indexOf("/",8),g=-1==n?"/":g.substring(n);b.replace(i,function(g,b,c){if(a)try{c=decodeURIComponent(c)}catch(n){}d[b]=c});c.pathname=g;c.params=d;y.set(b,c)}return c},objectToPath:function(b,a){var c=b.pathname,d=[],g=b.params,n,k;for(k in g)n=
g[k],a&&encodeURIComponent(n),d.push(k+"="+n);return c+(c&&d.length?"?":"")+d.join("&")},tmpl:function(b,a){return 1==arguments.length?{v:p[b],h:e(p,b)}:p[b]=a},listToMap:function(b,a){var c,d,g={},n;this.isString(b)&&(b=b.split(","));if(b&&(n=b.length))for(c=0;c<n;c++)d=b[c],g[a?d[a]:d]=a?d:1;return g},cache:d};return j(c,{libRequire:function(b,c){b?h.use(b.toString(),function(b){c&&c.apply(b,a.call(arguments,1))}):c&&c()},libEnv:function(b){var a=b.appHome,c=location,d=b.appName,a=this.path(c.href,
a+"/");b.appHome=a;var g=b.debug;g&&(g=0==a.indexOf(c.protocol+"//"+c.host+"/"));c="";(c=g?h.now():b.appTag)&&(c+=".js");h.config({packages:[{name:d,path:a,debug:b.debug=g,combine:b.appCombine,tag:c}]})},isArray:h.isArray,isFunction:h.isFunction,isObject:h.isObject,isRegExp:h.isRegExp,isString:h.isString,isNumber:h.isNumber})});
KISSY.add("magix/router",function(h,a,u,x){var f=window,i=a.has,q=a.mix,p=document,v=/^UTF-8$/i.test(p.charset||p.characterSet||"UTF-8"),l=a.config(),r=a.cache(),t=a.cache(),s,d,e,j=65536,y=/#.*$/,k=/^[^#]*#?!?/,o=l.nativeHistory,c,b,B=function(b,c,g){if(b){g=this.params;a.isArray(b)||(b=b.split(","));for(var d=0;d<b.length&&!(c=i(g,b[d]));d++);}return c},m=function(){return i(this,"pathname")},w=function(){return i(this,"view")},g=function(){return this.hash.pathname!=this.query.pathname},n=function(b){return this.hash.params[b]!=
this.query.params[b]},A=function(b){return i(this.hash.params,b)},D=function(b){return i(this.query.params,b)},E=function(b){return this.params[b]},C=function(c){var c=a.pathToObject(c,v),g=c.pathname;g&&b&&(c.pathname=a.path(f.location.pathname,g));return c},z=q({getView:function(b){if(!e){e={rs:l.routes||{},nf:l.notFoundView};var c=l.defaultView;if(!c)throw Error("unset defaultView");e.home=c;var g=l.defaultPathname||"";e.rs[g]=c;e.pathname=g}b||(b=e.pathname);c=e.rs;c=a.isFunction(c)?c.call(l,
b):c[b];return{view:c?c:e.nf||e.home,pathname:c?b:e.nf?b:e.pathname}},start:function(){var g=z,a=f.history;c=o&&a.pushState;b=o&&!c;c?g.useState():g.useHash();g.route()},parseQH:function(b){var b=b||f.location.href,c=z,a=r.get(b);if(!a){var a=b.replace(y,""),d=b.replace(k,""),e=C(a),i=C(d),m={};q(m,e.params);q(m,i.params);a={pathnameDiff:g,paramDiff:n,hashOwn:A,queryOwn:D,get:E,href:b,srcQuery:a,srcHash:d,query:e,hash:i,params:m};r.set(b,a)}a.view||(b=c.getView(o?a.hash.pathname||a.query.pathname:
a.hash.pathname),q(a,b));return a},getChged:function(b,c){var a=c.href,g=b.href+"\n"+a,d=t.get(g);d||(g=a+"\n"+g,d=t.get(g));if(!d){var n,d={params:{}};if(b.pathname!=c.pathname)n=d.pathname=1;if(b.view!=c.view)n=d.view=1;var a=b.params,k=c.params,e;for(e in a)a[e]!=k[e]&&(n=1,d.params[e]=1);for(e in k)a[e]!=k[e]&&(n=1,d.params[e]=1);d.occur=n;d.isParam=B;d.isPathname=m;d.isView=w;t.set(g,d)}return d},route:function(){var b=z,c=b.parseQH(),a=d||{params:{},href:"~"},g=!d;d=c;a=b.getChged(a,c);a.occur&&
(s=c,b.fire("changed",{location:c,changed:a,force:g}))},navigate:function(g,d){var n=z;!d&&a.isObject(g)&&(d=g,g="");d&&(g=a.objectToPath({params:d,pathname:g},v));if(g){var k=C(g),e={};e.params=q({},k.params);e.pathname=k.pathname;if(e.pathname){if(b&&(k=s.query)&&(k=k.params))for(var o in k)i(k,o)&&!i(e.params,o)&&(e.params[o]="")}else o=q({},s.params),e.params=q(o,e.params),e.pathname=s.pathname;o=a.objectToPath(e);if(c?o!=s.srcQuery:o!=s.srcHash)c?(n.poped=1,history.pushState(j--,p.title,o),n.route()):
(q(e,s,e),e.srcHash=o,e.hash={params:e.params,pathname:e.pathname},n.fire("!ul",{loc:s=e}),location.hash="#!"+o)}}},u);z.useState=function(){var b=z,c=location.href;x.on(f,"popstate",function(){var a=location.href==c;if(b.poped||!a)b.poped=1,b.route()})};z.useHash=function(){x.on(f,"hashchange",z.route)};return z},{requires:["magix/magix","magix/event","event"]});
KISSY.add("magix/vframe",function(h,a,u,x){var f=document,i=65536,q=window.CollectGarbage||a.noop,p=a.mix,h=a.config(),v=h.tagName,l=h.rootId,r=a.has,t,s,d=function(a){return"object"==typeof a?a:f.getElementById(a)};f.createElement(v);var e=/<script[^>]*>[\s\S]*?<\/script>/ig,j,y=function(a){this.id=a;this.cM={};this.rC=this.cC=0;this.sign=-2147483648;this.rM={}};p(y,{root:function(a,e){if(!t){j=e;var c=d(l);if(!c)c=f.createElement(v),c.id=l,f.body.insertBefore(c,f.body.firstChild);t=new y(l);a.add(t)}return t}});
p(p(y.prototype,u),{mountView:function(k,o){var c=this,b=d(c.id);b._bak?b._chgd=1:(b._bak=1,b._tmpl=b.innerHTML.replace(e,""));c.unmountView();if(k){var f=a.pathToObject(k),i=f.pathname,h=--c.sign;a.libRequire(i,function(a){if(h==c.sign){var e=c.owner;x.prepare(a);var k=new a({owner:c,id:c.id,$:d,path:i,vom:e,location:j});c.view=k;k.on("interact",function(a){if(!a.tmpl){if(b._chgd)b.innerHTML=b._tmpl;c.mountZoneVframes(0,0,1)}k.on("rendered",function(){c.mountZoneVframes(0,0,1)});k.on("prerender",
function(){c.unmountZoneVframes()});k.on("inited",function(){c.viewInited=1;c.fire("viewInited",{view:k})})},0);o=o||{};k.load(p(o,f.params,o))}})}},unmountView:function(){if(this.view){s||(s={caused:this.id});this.unmountZoneVframes();this.cAlter(s);this.view.destroy();var a=d(this.id);if(a&&a._bak)a.innerHTML=a._tmpl;delete this.view;delete this.viewInited;s=0;this.fire("viewUnmounted");q()}this.un("viewInited");this.sign--},mountVframe:function(a,d,c,b){var e=this.owner,f=e.get(a);if(!f)f=new y(a),
f.pId=this.id,r(this.cM,a)||this.cC++,this.cM[a]=b,e.add(f);f.mountView(d,c);return f},mountZoneVframes:function(a,e,c){this.unmountZoneVframes(a);var a=d(a||this.id).getElementsByTagName(v),b=a.length,f={};if(b)for(var h=0,j,g,n,A;h<b;h++){j=a[h];g=j.id||(j.id="magix_vf_"+i--);r(f,g)||(n=j.getAttribute("mx-view"),A=j.getAttribute("mx-defer"),(!A||n)&&this.mountVframe(g,n,e,c));j=d(j).getElementsByTagName(v);g=0;for(n=j.length;g<n;g++)f[j[g].id||(j[g].id="magix_vf_"+i--)]=1}this.cC==this.rC&&this.cCreated({})},
unmountVframe:function(a){var a=a||this.id,d=this.owner,c=d.get(a);if(c){var b=c.fcc;c.unmountView();d.remove(a,b);if((d=d.get(c.pId))&&r(d.cM,a))delete d.cM[a],d.cC--}},unmountZoneVframes:function(a){if(a){for(var a=d(a).getElementsByTagName(v),e={},c=this.cM,b=a.length-1,f;0<=b;b--)f=a[b].id,r(c,f)&&(e[f]=1);a=e}else a=this.cM;for(var i in a)this.unmountVframe(i)},cCreated:function(a){var d=this.view;if(d&&!this.fcc)this.fcc=1,delete this.fca,d.fire("created",a),this.fire("created",a);var c=this.owner;
c.vfCreated();d=this.id;if((c=c.get(this.pId))&&!r(c.rM,d))c.rM[d]=c.cM[d],c.rC++,c.rC==c.cC&&c.cCreated(a)},cAlter:function(a){delete this.fcc;if(!this.fca){var d=this.view,c=this.id;if(d)this.fca=1,d.fire("alter",a),this.fire("alter",a);if((d=this.owner.get(this.pId))&&r(d.rM,c)){var b=d.rM[c];d.rC--;delete d.rM[c];b&&d.cAlter(a)}}},locChged:function(d,e){var c=this.view;if(c&&c.sign&&c.rendered){var b=c.olChanged(e),f={location:d,changed:e,prevent:function(){this.cs=[]},toChildren:function(b){b=
b||[];a.isString(b)&&(b=b.split(","));this.cs=b}};b&&a.safeExec(c.locationChange,f,c);for(var c=f.cs||a.keys(this.cM),b=0,f=c.length,i=this.owner,h;b<f;b++)(h=i.get(c[b]))&&h.locChged(d,e)}}});return y},{requires:["magix/magix","magix/event","magix/view"]});
KISSY.add("magix/view",function(h,a,u,x,f){var i=a.safeExec,q=a.has,p=[],v=a.config(),l=a.mix,r=a.listToMap("render,renderUI"),t=function(a){return function(){var b;this.sign&&(this.sign++,this.fire("rendercall"),b=a.apply(this,arguments));return b}},s=a.cache(40),d=function(a){l(this,a);this.sign=1};l(d,{wrapAsyn:function(){if(!this["~"]){this["~"]=1;var b=this.prototype,c,d;for(d in r)c=b[d],a.isFunction(c)&&c!=a.noop&&(b[d]=t(c))}}});var e=d.prototype,j=window.CollectGarbage||a.noop,y=/<[a-z]+(?:[^">]|"[^"]*")+(?=>)/g,
k=/\smx-owner\s*=/,o=/\smx-[^v][a-z]+\s*=/,c=function(a){return!k.test(a)&&o.test(a)?a+' mx-owner="'+c.t+'"':a},b={prevent:function(a){a=a||this.domEvent;a.preventDefault?a.preventDefault():a.returnValue=!1},stop:function(a){a=a||this.domEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},halt:function(a){this.prevent(a);this.stop(a)}},B=/(\w+)(?:<(\w+)>)?(?:{([\s\S]*)})?/,m=/(\w+):([^,]+)/g;l(e,u);l(e,{render:a.noop,locationChange:a.noop,init:a.noop,hasTmpl:!0,enableEvent:!0,load:function(){var a=
this,b=a.hasTmpl,c=arguments,d=a.sign,e=q(a,"template"),f=function(f){if(d==a.sign){if(!e)a.template=a.wrapMxEvent(f);a.delegateEvents();a.fire("interact",{tmpl:b},1);i(a.init,c,a);a.fire("inited",0,1);i(a.render,p,a);if(!b&&!a.rendered)a.rendered=!0,a.fire("primed",null,1)}};b&&!e?a.fetchTmpl(f):f()},beginUpdateHTML:function(){this.sign&&this.rendered&&(this.fire("refresh",0,1),this.fire("prerender"))},endUpdateHTML:function(){if(this.sign)this.rendered||this.fire("primed",0,1),this.rendered=!0,
this.fire("rendered"),j()},wrapMxEvent:function(a){c.t=this.id;return(""+a).replace(y,c)},setViewHTML:function(a){this.beginUpdateHTML();if(this.sign)this.$(this.id).innerHTML=a;this.endUpdateHTML()},observeLocation:function(b){var c;if(!this.$ol)this.$ol={keys:[]};c=this.$ol;var d=c.keys;if(a.isObject(b))c.pn=b.pathname,b=b.keys;if(b)c.keys=d.concat(a.isString(b)?b.split(","):b)},olChanged:function(a){var b=this.$ol;if(b){var c=0;b.pn&&(c=a.isPathname());c||(c=a.isParam(b.keys));return c}return 1},
destroy:function(){this.fire("refresh",0,1);this.fire("destroy",0,1,1);this.delegateEvents(1);this.sign=0},parentView:function(){var a=this.vom.get(this.owner.pId),b=null;if(a&&a.viewInited)b=a.view;return b},processEvent:function(a){if(this.enableEvent&&this.sign){var c=a.info,d=a.se,e=s.get(c);e||(e=c.match(B),e={n:e[1],f:e[2],i:e[3],p:{}},e.i&&e.i.replace(m,function(a,b,c){e.p[b]=c}),s.set(c,e));if(c=this.events){var f=c[d.type],h=b[e.f];h&&h.call(b,d);(h=f&&f[e.n])&&i(h,l({view:this,currentId:a.cId,
targetId:a.tId,domEvent:d,events:c,params:e.p},b),f)}}},delegateEvents:function(a){var b=this.events,a=a?x.un:x.on,c=this.vom,d;for(d in b)a.call(x,d,c)}});var w=function(a,b,c){for(var d in b)h.isObject(b[d])?(q(a,d)||(a[d]={}),w(a[d],b[d],1)):c&&(a[d]=b[d])};d.prototype.fetchTmpl=function(b){var c=this,d=c.template;if(h.isUndefined(d))if(d=a.tmpl(c.path),d.h)b(d.v);else{var e=v.appHome+c.path+".html",j=w[e],d=function(d){b(a.tmpl(c.path,d))};j?j.push(d):(j=w[e]=[d],f({url:e+(v.debug?"?t="+h.now():
""),success:function(a){i(j,a);delete w[e]},error:function(a,b){i(j,b);delete w[e]}}))}else b(d)};d.extend=function(a,b){var c=function(){c.superclass.constructor.apply(this,arguments);b&&i(b,arguments,this)};c.extend=this.extend;return h.extend(c,this,a)};d.prepare=function(a){if(!a.wrapAsyn){a.wrapAsyn=this.wrapAsyn;a.extend=this.extend;for(var b=a.prototype,c=a.superclass;c;)c=c.constructor,w(b,c.prototype),c=c.superclass}a.wrapAsyn()};return d},{requires:["magix/magix","magix/event","magix/body",
"ajax"]});
KISSY.add("magix/vom",function(h,a,u,x){var f=u.has,i=u.mix,q=0,p=0,v=0,l=0,r={},t={},s=u.mix({all:function(){return r},add:function(a){if(!f(r,a.id))q++,r[a.id]=a,a.owner=s,s.fire("add",{vframe:a})},get:function(a){return r[a]},remove:function(a,e){var f=r[a];f&&(q--,e&&p--,delete r[a],s.fire("remove",{vframe:f}))},vfCreated:function(){if(!l){p++;var a=p/q;v<a&&s.fire("progress",{percent:v=a},l=1==a)}},root:function(){return a.root(s,t)},locChged:function(a){var e=a.loc,f;e?f=1:e=a.location;i(t,
e);if(!f)f=s.root(),a=a.changed,a.isView()?f.mountView(e.view):f.locChged(e,a)}},x);return s},{requires:["magix/vframe","magix/magix","magix/event"]});(function(h){var a=function(){};if(!h.console)h.console={log:a,info:a,error:a};var u,x={};if(!h.Magix)h.Magix={config:function(a){for(var h in a)x[h]=a[h]},start:function(a){u=a}},KISSY.use("magix/magix",function(a,i){h.Magix=i;i.config(x);u&&i.start(u)})})(this);