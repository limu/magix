KISSY.add("magix/body",function(h,a,t){var w=a.has,g=a.listToMap("submit,focusin,focusout,mouseenter,mouseleave,mousewheel,change"),i=document.body,q={},p={},u=65536,l=function(j,d,e){e?j.setAttribute(d,e):e=j.getAttribute(d);return e},r,s={process:function(j){for(var d=j.target||j.srcElement;d&&1!=d.nodeType;)d=d.parentNode;var e=d,a=j.type,g=p[a]||(p[a]=RegExp("(?:^|,)"+a+"(?:,|$)"));if(!g.test(l(d,"mx-ie"))){for(var k="mx-"+a,o,b,c=[];e&&e!=i&&!(o=l(e,k),b=l(e,"mx-ie"),o||g.test(b));)c.push(e),
e=e.parentNode;if(o){a=l(e,"mx-owner");if(!a){g=e;for(b=r.all();g&&g!=i;)if(w(b,g.id)){l(e,"mx-owner",a=g.id);break}else g=g.parentNode}if(a)(a=(a=r.get(a))&&a.view)&&a.processEvent({info:o,se:j,tId:d.id||(d.id="mx-e-"+u--),cId:e.id||(e.id="mx-e-"+u--)});else throw Error("miss mx-owner:"+o);}else for(;c.length;)j=c.shift(),b=l(j,"mx-ie"),g.test(b)||(b=b?b+","+a:a,l(j,"mx-ie",b))}},on:function(a,d){var e=this;q[a]?q[a]++:(r=d,q[a]=1,g[a]?e.unbubble(0,i,a):i["on"+a]=function(a){(a=a||window.event)&&
e.process(a)})},un:function(a){var d=q[a];0<d&&(d--,d||(g[a]?this.unbubble(1,i,a):i["on"+a]=null),q[a]=d)}};s.unbubble=function(a,d,e){(a?t.undelegate:t.delegate).call(t,d,e,"[mx-"+e+"]",s.process)};return s},{requires:["magix/magix","event","sizzle"]});
KISSY.add("magix/event",function(h,a){var t=a.safeExec;return{fire:function(a,g,i,q){var p="~"+a,h=this[p];if(h){g||(g={});if(!g.type)g.type=a;for(var a=h.length,l=a-1,r,s;a--;){r=q?a:l-a;s=h[r];if(s.d||s.r)h.splice(r,1),l--;s.d||t(s.f,g,this)}}i&&delete this[p]},on:function(h,g,i){h="~"+h;h=this[h]||(this[h]=[]);a.isNumeric(i)?h.splice(i,0,{f:g}):h.push({f:g,r:i})},un:function(a,g){var i="~"+a,h=this[i];if(h)if(g)for(var i=h.length-1,p;0<=i;i--){if(p=h[i],p.f==g&&!p.d){p.d=1;break}}else delete this[i]}}},
{requires:["magix/magix"]});
KISSY.add("magix/magix",function(h){var a=[].slice,t=/\/\.\/|\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,w=/\/[^\/]*$/,g=/[#?].*$/,i=/([^=&?\/#]+)=([^&=#?]*)/g,q=/^https?:\/\//i,p={},u=0,l={debug:false,iniFile:"app/ini",appName:"app",appHome:"./",tagName:"vframe",rootId:"magix_vf_root"},r=p.hasOwnProperty,s=function(c){return function(a,m,v){switch(arguments.length){case 0:v=c;break;case 1:v=b.isObject(a)?x(c,a):e(c,a)?c[a]:null;break;case 2:null===m?(delete c[a],v=m):c[a]=v=m}return v}},j=function(c){this.c=
[];this.x=c||20;this.b=this.x+5},d=function(c){return new j(c)},e=function(c,a){return c?r.call(c,a):0},x=function(c,a,m){for(var b in a)if(!m||!e(m,b))c[b]=a[b];return c};x(j.prototype,{get:function(c){var a=this.c,m,c="pathname"+c;if(e(a,c)&&(m=a[c],1<=m.f))m.f++,m.t=u++,m=m.v;return m},set:function(c,a){var m=this.c,c="pathname"+c,b=m[c];if(!e(m,c)){if(m.length>=this.b){m.sort(function(f,c){return c.f==f.f?c.t-f.t:c.f-f.f});for(var f=this.b-this.x;f--;)b=m.pop(),delete m[b.k]}b={};m.push(b);m[c]=
b}b.k=c;b.v=a;b.f=1;b.t=u++;return b},del:function(c){var c="pathname"+c,a=this.c,b=a[c];if(b)b.f=-1E5,b.v="",delete a[c]},has:function(c){return e(this.c,"pathname"+c)}});var y=d(60),k=d(),o=function(c,a,m,v,f,n){b.isArray(c)||(c=[c]);if(!a||!b.isArray(a)&&!a.callee)a=[a];for(v=0;v<c.length;v++)try{n=c[v],f=b.isFunction(n)&&n.apply(m,a)}catch(d){}return f},b={isNumeric:function(c){return!isNaN(parseFloat(c))&&isFinite(c)},mix:x,has:e,safeExec:o,noop:function(){},config:s(l),start:function(c){var a=
this,c=x(l,c);a.libEnv(c);a.libRequire(c.iniFile,function(b){l=x(c,b,c);var d=c.progress;a.libRequire(["magix/router","magix/vom"],function(f,b){f.on("!ul",b.locChged);f.on("changed",b.locChged);d&&b.on("progress",d);a.libRequire(c.extensions,f.start)})});c.ready&&(o(c.ready),delete c.ready)},keys:Object.keys||function(c){var a=[],b;for(b in c)e(c,b)&&a.push(b);return a},local:s({}),path:function(c,a){var b=c+"\n"+a,d=k.get(b);if(!d){q.test(a)?d=a:(c=c.replace(g,"").replace(w,"")+"/","/"==a.charAt(0)?
(d=q.test(c)?8:0,d=c.indexOf("/",d),d=c.substring(0,d)+a):d=c+a);for(;t.test(d);)d=d.replace(t,"$1/");k.set(b,d)}return d},pathToObject:function(c,a){var b=y.get(c);if(!b){var b={},d={},f="";g.test(c)?f=c.replace(g,""):~c.indexOf("=")||(f=c);if(f&&q.test(f))var n=f.indexOf("/",8),f=-1==n?"/":f.substring(n);c.replace(i,function(f,c,b){if(a)try{b=decodeURIComponent(b)}catch(n){}d[c]=b});b.pathname=f;b.params=d;y.set(c,b)}return b},objectToPath:function(c,a){var b=c.pathname,d=[],f=c.params,n,k;for(k in f)n=
f[k],a&&encodeURIComponent(n),d.push(k+"="+n);return b+(b&&d.length?"?":"")+d.join("&")},tmpl:function(c,a){return 1==arguments.length?{v:p[c],h:e(p,c)}:p[c]=a},listToMap:function(c,a){var b,d,f={},n;this.isString(c)&&(c=c.split(","));if(c&&(n=c.length))for(b=0;b<n;b++)d=c[b],f[a?d[a]:d]=a?d:1;return f},cache:d};return x(b,{libRequire:function(c,b){c?h.use(c.toString(),function(c){b&&b.apply(c,a.call(arguments,1))}):b&&b()},libEnv:function(a){var b=a.appHome,d=location,k=a.appName,b=this.path(d.href,
b+"/");a.appHome=b;var f=a.debug;f&&(f=0==b.indexOf(d.protocol+"//"+d.host+"/"));d="";(d=f?h.now():a.appTag)&&(d+=".js");h.config({packages:[{name:k,path:b,debug:a.debug=f,combine:a.appCombine,tag:d}]})},isArray:h.isArray,isFunction:h.isFunction,isObject:h.isObject,isRegExp:h.isRegExp,isString:h.isString,isNumber:h.isNumber})});
KISSY.add("magix/router",function(h,a,t,w){var g=window,i=a.has,q=a.mix,p=document,u=/^UTF-8$/i.test(p.charset||p.characterSet||"UTF-8"),l=a.config(),r=a.cache(),s=a.cache(),j,d,e,x=65536,y=/#.*$/,k=/^[^#]*#?!?/,o=l.nativeHistory,b,c,B=function(f,b,c){if(f){c=this.params;a.isArray(f)||(f=f.split(","));for(var d=0;d<f.length&&!(b=i(c,f[d]));d++);}return b},m=function(){return i(this,"pathname")},v=function(){return i(this,"view")},f=function(){return this.hash.pathname!=this.query.pathname},n=function(a){return this.hash.params[a]!=
this.query.params[a]},A=function(a){return i(this.hash.params,a)},D=function(a){return i(this.query.params,a)},E=function(a){return this.params[a]},C=function(f){var f=a.pathToObject(f,u),b=f.pathname;b&&c&&(f.pathname=a.path(g.location.pathname,b));return f},z=q({getView:function(f){if(!e){e={rs:l.routes||{},nf:l.notFoundView};var b=l.defaultView;if(!b)throw Error("unset defaultView");e.home=b;var c=l.defaultPathname||"";e.rs[c]=b;e.pathname=c}f||(f=e.pathname);b=e.rs;b=a.isFunction(b)?b.call(l,
f):b[f];return{view:b?b:e.nf||e.home,pathname:b?f:e.nf?f:e.pathname}},start:function(){var a=z,f=g.history;b=o&&f.pushState;c=o&&!b;b?a.useState():a.useHash();a.route()},parseQH:function(a){var a=a||g.location.href,b=z,c=r.get(a);if(!c){var c=a.replace(y,""),d=a.replace(k,""),e=C(c),i=C(d),m={};q(m,e.params);q(m,i.params);c={pathnameDiff:f,paramDiff:n,hashOwn:A,queryOwn:D,get:E,href:a,srcQuery:c,srcHash:d,query:e,hash:i,params:m};r.set(a,c)}c.view||(a=b.getView(o?c.hash.pathname||c.query.pathname:
c.hash.pathname),q(c,a));return c},getChged:function(a,f){var b=f.href,c=a.href+"\n"+b,d=s.get(c);d||(c=b+"\n"+c,d=s.get(c));if(!d){var n,d={params:{}};if(a.pathname!=f.pathname)n=d.pathname=1;if(a.view!=f.view)n=d.view=1;var b=a.params,k=f.params,e;for(e in b)b[e]!=k[e]&&(n=1,d.params[e]=1);for(e in k)b[e]!=k[e]&&(n=1,d.params[e]=1);d.occur=n;d.isParam=B;d.isPathname=m;d.isView=v;s.set(c,d)}return d},route:function(){var a=z,f=a.parseQH(),b=d||{params:{},href:"~"},c=!d;d=f;b=a.getChged(b,f);b.occur&&
(j=f,a.fire("changed",{location:f,changed:b,force:c}))},navigate:function(f,d){var n=z;!d&&a.isObject(f)&&(d=f,f="");d&&(f=a.objectToPath({params:d,pathname:f},u));if(f){var k=C(f),e={};e.params=q({},k.params);e.pathname=k.pathname;if(e.pathname){if(c&&(k=j.query)&&(k=k.params))for(var o in k)i(k,o)&&!i(e.params,o)&&(e.params[o]="")}else o=q({},j.params),e.params=q(o,e.params),e.pathname=j.pathname;o=a.objectToPath(e);if(b?o!=j.srcQuery:o!=j.srcHash)b?(n.poped=1,history.pushState(x--,p.title,o),n.route()):
(q(e,j,e),e.srcHash=o,e.hash={params:e.params,pathname:e.pathname},n.fire("!ul",{loc:j=e}),location.hash="#!"+o)}}},t);z.useState=function(){var a=z,f=location.href;w.on(g,"popstate",function(){var b=location.href==f;if(a.poped||!b)a.poped=1,a.route()})};z.useHash=function(){w.on(g,"hashchange",z.route)};return z},{requires:["magix/magix","magix/event","event"]});
KISSY.add("magix/vframe",function(h,a,t,w){var g=document,i=65536,q=window.CollectGarbage||a.noop,p=a.mix,h=a.config(),u=h.tagName,l=h.rootId,r=a.has,s,j,d=function(a){return"object"==typeof a?a:g.getElementById(a)};g.createElement(u);var e=/<script[^>]*>[\s\S]*?<\/script>/ig,x,y=function(a){this.id=a;this.cM={};this.rC=this.cC=0;this.sign=-2147483648;this.rM={}};p(y,{root:function(a,e){if(!s){x=e;var b=d(l);if(!b)b=g.createElement(u),b.id=l,g.body.insertBefore(b,g.body.firstChild);s=new y(l);a.add(s)}return s}});
p(p(y.prototype,t),{mountView:function(k,o){var b=this,c=d(b.id);c._bak?c._chgd=1:(c._bak=1,c._tmpl=c.innerHTML.replace(e,""));b.unmountView();if(k){var g=a.pathToObject(k),i=g.pathname,h=--b.sign;a.libRequire(i,function(a){if(h==b.sign){var e=b.owner;w.prepare(a);var k=new a({owner:b,id:b.id,$:d,path:i,vom:e,location:x});b.view=k;k.on("interact",function(a){if(!a.tmpl){if(c._chgd)c.innerHTML=c._tmpl;b.mountZoneVframes(0,0,1)}k.on("rendered",function(){b.mountZoneVframes(0,0,1)});k.on("prerender",
function(){b.unmountZoneVframes()});k.on("inited",function(){b.viewInited=1;b.fire("viewInited",{view:k})})},0);o=o||{};k.load(p(o,g.params,o))}})}},unmountView:function(){if(this.view){j||(j={caused:this.id});this.unmountZoneVframes();this.cAlter(j);this.view.destroy();var a=d(this.id);if(a&&a._bak)a.innerHTML=a._tmpl;delete this.view;delete this.viewInited;j=0;this.fire("viewUnmounted");q()}this.un("viewInited");this.sign--},mountVframe:function(a,d,b,c){var e=this.owner,g=e.get(a);if(!g)g=new y(a),
g.pId=this.id,r(this.cM,a)||this.cC++,this.cM[a]=c,e.add(g);g.mountView(d,b);return g},mountZoneVframes:function(a,e,b){this.unmountZoneVframes(a);var a=d(a||this.id).getElementsByTagName(u),c=a.length,g={};if(c)for(var h=0,j,f,n,A;h<c;h++){j=a[h];f=j.id||(j.id="magix_vf_"+i--);r(g,f)||(n=j.getAttribute("mx-view"),A=j.getAttribute("mx-defer"),(!A||n)&&this.mountVframe(f,n,e,b));j=d(j).getElementsByTagName(u);f=0;for(n=j.length;f<n;f++)g[j[f].id||(j[f].id="magix_vf_"+i--)]=1}this.cC==this.rC&&this.cCreated({})},
unmountVframe:function(a){var a=a||this.id,d=this.owner,b=d.get(a);if(b){var c=b.fcc;b.unmountView();d.remove(a,c);if((d=d.get(b.pId))&&r(d.cM,a))delete d.cM[a],d.cC--}},unmountZoneVframes:function(a){if(a){for(var a=d(a).getElementsByTagName(u),e={},b=this.cM,c=a.length-1,g;0<=c;c--)g=a[c].id,r(b,g)&&(e[g]=1);a=e}else a=this.cM;for(var i in a)this.unmountVframe(i)},cCreated:function(a){var d=this.view;if(d&&!this.fcc)this.fcc=1,delete this.fca,d.fire("created",a),this.fire("created",a);var b=this.owner;
b.vfCreated();d=this.id;if((b=b.get(this.pId))&&!r(b.rM,d))b.rM[d]=b.cM[d],b.rC++,b.rC==b.cC&&b.cCreated(a)},cAlter:function(a){delete this.fcc;if(!this.fca){var d=this.view,b=this.id;if(d)this.fca=1,d.fire("alter",a),this.fire("alter",a);if((d=this.owner.get(this.pId))&&r(d.rM,b)){var c=d.rM[b];d.rC--;delete d.rM[b];c&&d.cAlter(a)}}},locChged:function(d,e){var b=this.view;if(b&&b.sign&&b.rendered){var c=b.olChanged(e),g={location:d,changed:e,prevent:function(){this.cs=[]},toChildren:function(f){f=
f||[];a.isString(f)&&(f=f.split(","));this.cs=f}};c&&a.safeExec(b.locationChange,g,b);for(var b=g.cs||a.keys(this.cM),c=0,g=b.length,i=this.owner,h;c<g;c++)(h=i.get(b[c]))&&h.locChged(d,e)}}});return y},{requires:["magix/magix","magix/event","magix/view"]});
KISSY.add("magix/view",function(h,a,t,w,g){var i=a.safeExec,q=a.has,p=[],u=a.config(),l=a.mix,r=["render","renderUI"],s=function(a){return function(){var b;this.notifyUpdate()&&(b=a.apply(this,arguments));return b}},j=a.cache(40),d=function(a){l(this,a);this.sign=1};l(d,{wrapUpdate:function(){if(!this["~"]){this["~"]=1;for(var f=this.prototype,b,c=r.length-1;-1<c;c--)b=f[r[c]],a.isFunction(b)&&b!=a.noop&&(f[c]=s(b))}}});var e=d.prototype,x=window.CollectGarbage||a.noop,y=/<[a-z]+(?:[^">]|"[^"]*")+(?=>)/g,
k=/\smx-owner\s*=/,o=/\smx-[^v][a-z]+\s*=/,b=function(a){return!k.test(a)&&o.test(a)?a+' mx-owner="'+b.t+'"':a},c={prevent:function(a){a=a||this.domEvent;a.preventDefault?a.preventDefault():a.returnValue=!1},stop:function(a){a=a||this.domEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},halt:function(a){this.prevent(a);this.stop(a)}},B=/(\w+)(?:<(\w+)>)?(?:{([\s\S]*)})?/,m=/(\w+):([^,]+)/g;l(e,t);l(e,{render:a.noop,locationChange:a.noop,init:a.noop,hasTmpl:!0,enableEvent:!0,load:function(){var a=
this,b=a.hasTmpl,c=arguments,d=a.sign,e=q(a,"template"),g=function(g){if(d==a.sign){if(!e)a.template=a.wrapMxEvent(g);a.delegateEvents();a.fire("interact",{tmpl:b},1);i(a.init,c,a);a.fire("inited",0,1);i(a.render,p,a);if(!b&&!a.rendered)a.rendered=!0,a.fire("primed",null,1)}};b&&!e?a.fetchTmpl(g):g()},beginUpdate:function(){this.sign&&this.rendered&&(this.fire("refresh",0,1),this.fire("prerender"))},endUpdate:function(){if(this.sign)this.rendered||this.fire("primed",0,1),this.rendered=!0,this.fire("rendered"),
x()},notifyUpdate:function(){this.sign&&(this.sign++,this.fire("rendercall"));return this.sign},wrapMxEvent:function(a){b.t=this.id;return(""+a).replace(y,b)},setViewHTML:function(a){var b;this.beginUpdate();if(this.sign&&(b=this.$(this.id)))b.innerHTML=a;this.endUpdate()},observeLocation:function(b){var c;if(!this.$ol)this.$ol={keys:[]};c=this.$ol;var d=c.keys;if(a.isObject(b))c.pn=b.pathname,b=b.keys;if(b)c.keys=d.concat(a.isString(b)?b.split(","):b)},olChanged:function(a){var b=this.$ol;if(b){var c=
0;b.pn&&(c=a.isPathname());c||(c=a.isParam(b.keys));return c}return 1},destroy:function(){this.fire("refresh",0,1);this.fire("destroy",0,1,1);this.delegateEvents(1);this.sign=0},parentView:function(){var a=this.vom.get(this.owner.pId),b=null;if(a&&a.viewInited)b=a.view;return b},processEvent:function(a){if(this.enableEvent&&this.sign){var b=a.info,d=a.se,e=j.get(b);e||(e=b.match(B),e={n:e[1],f:e[2],i:e[3],p:{}},e.i&&e.i.replace(m,function(a,b,c){e.p[b]=c}),j.set(b,e));if(b=this.events){var g=b[d.type],
h=c[e.f];h&&h.call(c,d);(h=g&&g[e.n])&&i(h,l({view:this,currentId:a.cId,targetId:a.tId,domEvent:d,events:b,params:e.p},c),g)}}},delegateEvents:function(a){var b=this.events,a=a?w.un:w.on,c=this.vom,d;for(d in b)a.call(w,d,c)}});var v=function(a,b,c){for(var d in b)h.isObject(b[d])?(q(a,d)||(a[d]={}),v(a[d],b[d],1)):c&&(a[d]=b[d])};d.prototype.fetchTmpl=function(b){var c=this,d=c.template;if(h.isUndefined(d))if(d=a.tmpl(c.path),d.h)b(d.v);else{var e=u.appHome+c.path+".html",j=v[e],d=function(d){b(a.tmpl(c.path,
d))};j?j.push(d):(j=v[e]=[d],g({url:e+(u.debug?"?t="+h.now():""),success:function(a){i(j,a);delete v[e]},error:function(a,b){i(j,b);delete v[e]}}))}else b(d)};d.extend=function(a,b){var c=function(){c.superclass.constructor.apply(this,arguments);b&&i(b,arguments,this)};c.extend=this.extend;return h.extend(c,this,a)};d.prepare=function(a){if(!a.wrapUpdate){a.wrapUpdate=this.wrapUpdate;a.extend=this.extend;for(var b=a.prototype,c=a.superclass;c;)c=c.constructor,v(b,c.prototype),c=c.superclass}a.wrapUpdate()};
return d},{requires:["magix/magix","magix/event","magix/body","ajax"]});
KISSY.add("magix/vom",function(h,a,t,w){var g=t.has,i=t.mix,q=0,p=0,u=0,l=0,r={},s={},j=t.mix({all:function(){return r},add:function(a){if(!g(r,a.id))q++,r[a.id]=a,a.owner=j,j.fire("add",{vframe:a})},get:function(a){return r[a]},remove:function(a,e){var g=r[a];g&&(q--,e&&p--,delete r[a],j.fire("remove",{vframe:g}))},vfCreated:function(){if(!l){p++;var a=p/q;u<a&&j.fire("progress",{percent:u=a},l=1==a)}},root:function(){return a.root(j,s)},locChged:function(a){var e=a.loc,g;e?g=1:e=a.location;i(s,
e);if(!g)g=j.root(),a=a.changed,a.isView()?g.mountView(e.view):g.locChged(e,a)}},w);return j},{requires:["magix/vframe","magix/magix","magix/event"]});(function(h){var a=function(){};if(!h.console)h.console={log:a,info:a,error:a};var t,w={};if(!h.Magix)h.Magix={config:function(a){for(var h in a)w[h]=a[h]},start:function(a){t=a}},KISSY.use("magix/magix",function(a,i){h.Magix=i;i.config(w);t&&i.start(t)})})(this);