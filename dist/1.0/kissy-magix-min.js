KISSY.add("magix/body",function(h,b,s){var v=b.has,e=b.listToMap("submit,focusin,focusout,mouseenter,mouseleave,mousewheel,change"),g=document.body,k={},p={},o=65536,n=function(b,d,f){f?b.setAttribute(d,f):f=b.getAttribute(d);return f},t,m={process:function(b){for(var d=b.target||b.srcElement;d&&1!=d.nodeType;)d=d.parentNode;var f=d,l=b.type,e=p[l]||(p[l]=RegExp("(?:^|,)"+l+"(?:,|$)"));if(!e.test(n(d,"mx-ie"))){for(var m="mx-"+l,k,c,a=[];f&&f!=g&&!(k=n(f,m),c=n(f,"mx-ie"),k||e.test(c));)a.push(f),
f=f.parentNode;if(k){l=n(f,"mx-owner");if(!l){e=f;for(c=t.all();e&&e!=g;)if(v(c,e.id)){n(f,"mx-owner",l=e.id);break}else e=e.parentNode}if(l)(l=(l=t.get(l))&&l.view)&&l.processEvent({info:k,se:b,tId:d.id||(d.id="mx-e-"+o--),cId:f.id||(f.id="mx-e-"+o--)});else throw Error("miss mx-owner:"+k);}else for(;a.length;)b=a.shift(),c=n(b,"mx-ie"),e.test(c)||(c=c?c+","+l:l,n(b,"mx-ie",c))}},on:function(b,d){var f=this;k[b]?k[b]++:(t=d,k[b]=1,e[b]?f.unbubble(0,g,b):g["on"+b]=function(b){(b=b||window.event)&&
f.process(b)})},un:function(b){var d=k[b];0<d&&(d--,d||(e[b]?this.unbubble(1,g,b):g["on"+b]=null),k[b]=d)}};m.unbubble=function(b,d,e){(b?s.undelegate:s.delegate).call(s,d,e,"[mx-"+e+"]",m.process)};return m},{requires:["magix/magix","event","sizzle"]});
KISSY.add("magix/event",function(h,b){var s=b.safeExec;return{fire:function(b,e,g,k){var p="~"+b,o=this[p];if(o){e||(e={});if(!e.type)e.type=b;for(var b=o.length,n=b-1,h,m;b--;){h=k?b:n-b;m=o[h];if(m.d||m.r)o.splice(h,1),n--;m.d||s(m.f,e,this)}}g&&delete this[p]},on:function(h,e,g){h="~"+h;h=this[h]||(this[h]=[]);b.isNumeric(g)?h.splice(g,0,{f:e}):h.push({f:e,r:g})},un:function(b,e){var g="~"+b,h=this[g];if(h)if(e)for(var g=h.length-1,p;0<=g;g--){if(p=h[g],p.f==e&&!p.d){p.d=1;break}}else delete this[g]}}},
{requires:["magix/magix"]});
KISSY.add("magix/magix",function(h){var b=[].slice,s=/\/\.\/|\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,v=/\/[^\/]*$/,e=/[#?].*$/,g=/([^=&?\/#]+)=([^&=#?]*)/g,k=/^https?:\/\//i,p={},o=0,n={debug:false,iniFile:"app/ini",appName:"app",appHome:"./",tagName:"vframe",rootId:"magix_vf_root"},t=p.hasOwnProperty,m=function(a){return function(i,A,b){switch(arguments.length){case 0:b=a;break;case 1:b=c.isObject(i)?l(a,i):f(a,i)?a[i]:null;break;case 2:null===A?(delete a[i],b=A):a[i]=b=A}return b}},r=function(a){this.c=
[];this.x=a||20;this.b=this.x+5},d=function(a){return new r(a)},f=function(a,i){return a?t.call(a,i):0},l=function(a,i,b){for(var c in i)if(!b||!f(b,c))a[c]=i[c];return a};l(r.prototype,{get:function(a){var i=this.c,b,a="pathname"+a;if(f(i,a)&&(b=i[a],1<=b.f))b.f++,b.t=o++,b=b.v;return b},set:function(a,i){var b=this.c,a="pathname"+a,c=b[a];if(!f(b,a)){if(b.length>=this.b){b.sort(function(a,i){return i.f==a.f?i.t-a.t:i.f-a.f});for(var d=this.b-this.x;d--;)c=b.pop(),delete b[c.k]}c={};b.push(c);b[a]=
c}c.k=a;c.v=i;c.f=1;c.t=o++;return c},del:function(a){var a="pathname"+a,i=this.c,b=i[a];if(b)b.f=-1E5,b.v="",delete i[a]},has:function(a){return f(this.c,"pathname"+a)}});var y=d(60),x=d(),w=function(a,i,b,d,e,j){c.isArray(a)||(a=[a]);if(!i||!c.isArray(i)&&!i.callee)i=[i];for(d=0;d<a.length;d++)try{j=a[d],e=c.isFunction(j)&&j.apply(b,i)}catch(u){}return e},c={isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},mix:l,has:f,safeExec:w,noop:function(){},config:m(n),start:function(a){var b=
this,a=l(n,a);b.libEnv(a);b.libRequire(a.iniFile,function(c){n=l(a,c,a);n.tagNameChanged="vframe"!=n.tagName;var d=a.progress;b.libRequire(["magix/router","magix/vom"],function(c,j){c.on("!ul",j.locChged);c.on("changed",j.locChged);d&&j.on("progress",d);b.libRequire(a.extensions,c.start)})});a.ready&&(w(a.ready),delete a.ready)},keys:Object.keys||function(a){var b=[],c;for(c in a)f(a,c)&&b.push(c);return b},local:m({}),path:function(a,b){var c=a+"\n"+b,d=x.get(c);if(!d){k.test(b)?d=b:(a=a.replace(e,
"").replace(v,"")+"/","/"==b.charAt(0)?(d=k.test(a)?8:0,d=a.indexOf("/",d),d=a.substring(0,d)+b):d=a+b);for(;s.test(d);)d=d.replace(s,"$1/");x.set(c,d)}return d},pathToObject:function(a,b){var c=y.get(a);if(!c){var c={},d={},f="";e.test(a)?f=a.replace(e,""):~a.indexOf("=")||(f=a);if(f&&k.test(f))var j=f.indexOf("/",8),f=-1==j?"/":f.substring(j);a.replace(g,function(a,j,c){if(b)try{c=decodeURIComponent(c)}catch(D){}d[j]=c});c.pathname=f;c.params=d;y.set(a,c)}return c},objectToPath:function(a,b){var c=
a.pathname,d=[],e=a.params,j,u;for(u in e)j=e[u],b&&encodeURIComponent(j),d.push(u+"="+j);return c+(c&&d.length?"?":"")+d.join("&")},tmpl:function(a,b){return 1==arguments.length?{v:p[a],h:f(p,a)}:p[a]=b},listToMap:function(a,b){var d,e,f={},j;c.isString(a)&&(a=a.split(","));if(a&&(j=a.length))for(d=0;d<j;d++)e=a[d],f[b?e[b]:e]=b?e:1;return f},cache:d};return l(c,{libRequire:function(a,c){a?h.use(""+a,function(a){c&&c.apply(a,b.call(arguments,1))}):c&&c()},libEnv:function(a){var b=a.appHome,c=location,
d=a.appName,b=this.path(c.href,b+"/");a.appHome=b;var e=a.debug;e&&(e=0==b.indexOf(c.protocol+"//"+c.host+"/"));c="";(c=e?h.now():a.appTag)&&(c+=".js");h.config({packages:[{name:d,path:b,debug:a.debug=e,combine:a.appCombine,tag:c}]})},isArray:h.isArray,isFunction:h.isFunction,isObject:h.isObject,isRegExp:h.isRegExp,isString:h.isString,isNumber:h.isNumber})});
KISSY.add("magix/router",function(h,b,s,v){var e=window,g=b.has,k=b.mix,h=document,p=/^UTF-8$/i.test(h.charset||h.characterSet||"UTF-8"),o=b.config(),n=b.cache(),t=b.cache(),m,r,d,f=/#.*$/,l=/^[^#]*#?!?/,y=o.nativeHistory,x,w,c=function(a,c,j){if(a){j=this.params;b.isArray(a)||(a=a.split(","));for(var d=0;d<a.length&&!(c=g(j,a[d]));d++);}return c},a=function(){return g(this,"pathname")},i=function(){return g(this,"view")},A=function(){return this.hash.pathname!=this.query.pathname},B=function(a){return this.hash.params[a]!=
this.query.params[a]},z=function(a){return g(this.hash.params,a)},j=function(a){return g(this.query.params,a)},u=function(a){return this.params[a]},C=function(a){var a=b.pathToObject(a,p),c=a.pathname;c&&w&&(a.pathname=b.path(e.location.pathname,c));return a},q=k({getView:function(a){if(!d){d={rs:o.routes||{},nf:o.notFoundView};var c=o.defaultView;if(!c)throw Error("unset defaultView");d.home=c;var j=o.defaultPathname||"";d.rs[j]=c;d.pathname=j}a||(a=d.pathname);c=d.rs;c=b.isFunction(c)?c.call(o,
a):c[a];return{view:c?c:d.nf||d.home,pathname:c?a:d.nf?a:d.pathname}},start:function(){var a=q,b=e.history;x=y&&b.pushState;w=y&&!x;x?a.useState():a.useHash();a.route()},parseQH:function(a){var a=a||e.location.href,b=q,c=n.get(a);if(!c){var c=a.replace(f,""),d=a.replace(l,""),i=C(c),g=C(d),h={};k(h,i.params);k(h,g.params);c={pathnameDiff:A,paramDiff:B,hashOwn:z,queryOwn:j,get:u,href:a,srcQuery:c,srcHash:d,query:i,hash:g,params:h};n.set(a,c)}c.view||(a=b.getView(y?c.hash.pathname||c.query.pathname:
c.hash.pathname),k(c,a));return c},getChged:function(b,j){var d=j.href,u=b.href+"\n"+d,e=t.get(u);e||(u=d+"\n"+u,e=t.get(u));if(!e){var q,e={params:{}};if(b.pathname!=j.pathname)q=e.pathname=1;if(b.view!=j.view)q=e.view=1;var d=b.params,f=j.params,g;for(g in d)d[g]!=f[g]&&(q=1,e.params[g]=1);for(g in f)d[g]!=f[g]&&(q=1,e.params[g]=1);e.occur=q;e.isParam=c;e.isPathname=a;e.isView=i;t.set(u,e)}return e},route:function(){var a=q,b=a.parseQH(),c=r||{params:{},href:"~"},j=!r;r=b;c=a.getChged(c,b);c.occur&&
(m=b,a.fire("changed",{location:b,changed:c,force:j}))},navigate:function(a,c,j){var d=q;!c&&b.isObject(a)&&(c=a,a="");c&&(a=b.objectToPath({params:c,pathname:a},p));if(a){c=C(a);a={};a.params=k({},c.params);a.pathname=c.pathname;if(a.pathname){if(w&&(c=m.query)&&(c=c.params))for(var i in c)g(c,i)&&!g(a.params,i)&&(a.params[i]="")}else i=k({},m.params),a.params=k(i,a.params),a.pathname=m.pathname;i=b.objectToPath(a);if(x?i!=m.srcQuery:i!=m.srcHash)x?(d.poped=1,history[j?"replaceState":"pushState"](null,
null,i),d.route()):(k(a,m,a),a.srcHash=i,a.hash={params:a.params,pathname:a.pathname},d.fire("!ul",{loc:m=a}),i="#!"+i,j?location.replace(i):location.hash=i)}}},s);q.useState=function(){var a=q,c=location.href;v.on(e,"popstate",function(){var b=location.href==c;if(a.poped||!b)a.poped=1,a.route()})};q.useHash=function(){v.on(e,"hashchange",q.route)};return q},{requires:["magix/magix","magix/event","event"]});
KISSY.add("magix/vframe",function(h,b,s,v){var e=document,g=65536,k=window.CollectGarbage||b.noop,p=b.mix,o=b.config("tagName"),n=b.config("rootId"),t=!b.config("tagNameChanged"),m=b.has,r=t?"mx-defer":"mx-vframe",d,f,l=function(c){return"object"==typeof c?c:e.getElementById(c)};e.createElement(o);var y=/<script[^>]*>[\s\S]*?<\/script>/ig,x,w=function(c){this.id=c;this.cM={};this.rC=this.cC=0;this.sign=-2147483648;this.rM={}};p(w,{root:function(c,a){if(!d){x=a;var b=l(n);if(!b)b=e.createElement(o),
b.id=n,e.body.insertBefore(b,e.body.firstChild);d=new w(n);c.add(d)}return d}});p(p(w.prototype,s),{mountView:function(c,a){var d=this,e=l(d.id);e._bak?e._chgd=1:(e._bak=1,e._tmpl=e.innerHTML.replace(y,""));d.unmountView();if(c){var f=b.pathToObject(c),g=f.pathname,j=--d.sign;b.libRequire(g,function(c){if(j==d.sign){var b=d.owner;v.prepare(c);var q=new c({owner:d,id:d.id,$:l,path:g,vom:b,location:x});d.view=q;q.on("interact",function(a){if(!a.tmpl){if(e._chgd)e.innerHTML=e._tmpl;d.mountZoneVframes(0,
0,1)}q.on("rendered",function(){d.mountZoneVframes(0,0,1)});q.on("prerender",function(){d.unmountZoneVframes()});q.on("inited",function(){d.viewInited=1;d.fire("viewInited",{view:q})})},0);a=a||{};q.load(p(a,f.params,a))}})}},unmountView:function(){if(this.view){f||(f={caused:this.id});this.unmountZoneVframes();this.cAlter(f);this.view.destroy();var c=l(this.id);if(c&&c._bak)c.innerHTML=c._tmpl;delete this.view;delete this.viewInited;f=0;this.fire("viewUnmounted");k()}this.un("viewInited");this.sign--},
mountVframe:function(c,a,b,d){var e=this.owner,f=e.get(c);if(!f)f=new w(c),f.pId=this.id,m(this.cM,c)||this.cC++,this.cM[c]=d,e.add(f);f.mountView(a,b);return f},mountZoneVframes:function(c,a,b){this.unmountZoneVframes(c);var c=l(c||this.id).getElementsByTagName(o),d=c.length,e={};if(d)for(var f=0,j,u,h,q;f<d;f++)if(j=c[f],u=j.id||(j.id="magix_vf_"+g--),!m(e,u)&&(h=j.getAttribute("mx-view"),(q=!j.getAttribute(r)==t)||h)){this.mountVframe(u,h,a,b);u=l(j).getElementsByTagName(o);for(var k=0,p=u.length,
n;k<p;k++)n=u[k],h=n.getAttribute("mx-view"),q=!j.getAttribute(r)==t,!q&&!h&&(e[n.id||(n.id="magix_vf_"+g--)]=1)}this.cC==this.rC&&this.cCreated({})},unmountVframe:function(c){var c=c||this.id,a=this.owner,b=a.get(c);if(b){var d=b.fcc;b.unmountView();a.remove(c,d);if((a=a.get(b.pId))&&m(a.cM,c))delete a.cM[c],a.cC--}},unmountZoneVframes:function(b){if(b){for(var b=l(b).getElementsByTagName(o),a={},d=this.cM,e=b.length-1,f;0<=e;e--)f=b[e].id,m(d,f)&&(a[f]=1);b=a}else b=this.cM;for(var g in b)this.unmountVframe(g)},
cCreated:function(b){var a=this.view;if(a&&!this.fcc)this.fcc=1,delete this.fca,a.fire("created",b),this.fire("created",b);var d=this.owner;d.vfCreated();a=this.id;if((d=d.get(this.pId))&&!m(d.rM,a))d.rM[a]=d.cM[a],d.rC++,d.rC==d.cC&&d.cCreated(b)},cAlter:function(b){delete this.fcc;if(!this.fca){var a=this.view,d=this.id;if(a)this.fca=1,a.fire("alter",b),this.fire("alter",b);if((a=this.owner.get(this.pId))&&m(a.rM,d)){var e=a.rM[d];a.rC--;delete a.rM[d];e&&a.cAlter(b)}}},locChged:function(c,a){var d=
this.view;if(d&&d.sign&&d.rendered){var e=d.olChanged(a),f={location:c,changed:a,prevent:function(){this.cs=[]},toChildren:function(a){a=a||[];b.isString(a)&&(a=a.split(","));this.cs=a}};e&&b.safeExec(d.locationChange,f,d);for(var d=f.cs||b.keys(this.cM),e=0,f=d.length,g=this.owner,j;e<f;e++)(j=g.get(d[e]))&&j.locChged(c,a)}}});return w},{requires:["magix/magix","magix/event","magix/view"]});
KISSY.add("magix/view",function(h,b,s,v,e){var g=b.safeExec,k=b.has,p=[],o=b.mix,n=["render","renderUI"],t=function(a){return function(){var b;this.notifyUpdate()&&(b=a.apply(this,arguments));return b}},m=b.cache(40),r=function(a){o(this,a);this.sign=1};o(r,{wrapUpdate:function(){if(!this["~"]){this["~"]=1;for(var a=this.prototype,d,c=n.length-1,e;-1<c;c--)e=n[c],d=a[e],b.isFunction(d)&&d!=b.noop&&(a[e]=t(d))}}});var d=r.prototype,f=window.CollectGarbage||b.noop,l=/<[a-z]+(?:[^">]|"[^"]*")+(?=>)/g,
y=/\smx-owner\s*=/,x=/\smx-[^v][a-z]+\s*=/,w=function(a){return!y.test(a)&&x.test(a)?a+' mx-owner="'+w.t+'"':a},c={prevent:function(a){a=a||this.domEvent;a.preventDefault?a.preventDefault():a.returnValue=!1},stop:function(a){a=a||this.domEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},halt:function(a){this.prevent(a);this.stop(a)}},a=/(\w+)(?:<(\w+)>)?(?:{([\s\S]*)})?/,i=/(\w+):([^,]+)/g;o(d,s);o(d,{render:b.noop,locationChange:b.noop,init:b.noop,hasTmpl:!0,enableEvent:!0,load:function(){var a=
this,b=a.hasTmpl,d=arguments,c=a.sign,e=k(a,"template"),f=function(f){if(c==a.sign){if(!e)a.template=a.wrapMxEvent(f);a.delegateEvents();a.fire("interact",{tmpl:b},1);g(a.init,d,a);a.fire("inited",0,1);g(a.render,p,a);if(!b&&!a.rendered)a.rendered=!0,a.fire("primed",null,1)}};b&&!e?a.fetchTmpl(f):f()},beginUpdate:function(){this.sign&&this.rendered&&(this.fire("refresh",0,1),this.fire("prerender"))},endUpdate:function(){if(this.sign)this.rendered||this.fire("primed",0,1),this.rendered=!0,this.fire("rendered"),
f()},notifyUpdate:function(){this.sign&&(this.sign++,this.fire("rendercall"));return this.sign},wrapMxEvent:function(a){w.t=this.id;return(""+a).replace(l,w)},setViewHTML:function(a){var b;this.beginUpdate();if(this.sign&&(b=this.$(this.id)))b.innerHTML=a;this.endUpdate()},observeLocation:function(a){var d;if(!this.$ol)this.$ol={keys:[]};d=this.$ol;var c=d.keys;if(b.isObject(a))d.pn=a.pathname,a=a.keys;if(a)d.keys=c.concat((""+a).split(","))},olChanged:function(a){var b=this.$ol;if(b){var d=0;b.pn&&
(d=a.isPathname());d||(d=a.isParam(b.keys));return d}return 1},destroy:function(){this.fire("refresh",0,1);this.fire("destroy",0,1,1);this.delegateEvents(1);this.sign=0},parentView:function(){var a=this.vom.get(this.owner.pId),b=null;if(a&&a.viewInited)b=a.view;return b},processEvent:function(b){if(this.enableEvent&&this.sign){var d=b.info,e=b.se,f=m.get(d);f||(f=d.match(a),f={n:f[1],f:f[2],i:f[3],p:{}},f.i&&f.i.replace(i,function(a,b,d){f.p[b]=d}),m.set(d,f));if(d=this.events){var h=d[e.type],l=
c[f.f];l&&l.call(c,e);(l=h&&h[f.n])&&g(l,o({view:this,currentId:b.cId,targetId:b.tId,domEvent:e,events:d,params:f.p},c),h)}}},delegateEvents:function(a){var b=this.events,a=a?v.un:v.on,d=this.vom,c;for(c in b)a.call(v,c,d)}});var A=b.config("appHome"),B=b.config("debug")?"?t="+h.now():"",z=function(a,b,d){for(var c in b)h.isObject(b[c])?(k(a,c)||(a[c]={}),z(a[c],b[c],1)):d&&(a[c]=b[c])};r.prototype.fetchTmpl=function(a){var d=this,c=d.template;if(h.isUndefined(c))if(c=b.tmpl(d.path),c.h)a(c.v);else{var f=
A+d.path+".html",i=z[f],c=function(c){a(b.tmpl(d.path,c))};i?i.push(c):(i=z[f]=[c],e({url:f+B,success:function(a){g(i,a);delete z[f]},error:function(a,b){g(i,b);delete z[f]}}))}else a(c)};r.extend=function(a,b,d){var c=function(){c.superclass.constructor.apply(this,arguments);b&&g(b,arguments,this)};c.extend=this.extend;return h.extend(c,this,a,d)};r.prepare=function(a){if(!a.wrapUpdate){a.wrapUpdate=this.wrapUpdate;a.extend=this.extend;for(var b=a.prototype,d=a.superclass;d;)d=d.constructor,z(b,
d.prototype),d=d.superclass}a.wrapUpdate()};return r},{requires:["magix/magix","magix/event","magix/body","ajax"]});
KISSY.add("magix/vom",function(h,b,s,v){var e=s.has,g=s.mix,k=0,p=0,o=0,n=0,t={},m={},r=s.mix({all:function(){return t},add:function(b){if(!e(t,b.id))k++,t[b.id]=b,b.owner=r,r.fire("add",{vframe:b})},get:function(b){return t[b]},remove:function(b,e){var g=t[b];g&&(k--,e&&p--,delete t[b],r.fire("remove",{vframe:g}))},vfCreated:function(){if(!n){p++;var b=p/k;o<b&&r.fire("progress",{percent:o=b},n=1==b)}},root:function(){return b.root(r,m)},locChged:function(b){var e=b.loc,h;e?h=1:e=b.location;g(m,
e);if(!h)h=r.root(),b=b.changed,b.isView()?h.mountView(e.view):h.locChged(e,b)}},v);return r},{requires:["magix/vframe","magix/magix","magix/event"]});(function(h){var b=function(){};if(!h.console)h.console={log:b,info:b,error:b};var s,v={};if(!h.Magix)h.Magix={config:function(b){for(var g in b)v[g]=b[g]},start:function(b){s=b}},KISSY.use("magix/magix",function(b,g){h.Magix=g;g.config(v);s&&g.start(s)})})(this);