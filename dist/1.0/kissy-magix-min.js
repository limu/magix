KISSY.add("magix/body",function(j,a,t){var v=a.has,h=a.listToMap("submit,focusin,focusout,mouseenter,mouseleave,mousewheel,change"),m=document.body,q={},p={},u=65536,o=function(n,e,g){g?n.setAttribute(e,g):g=n.getAttribute(e);return g},r,s={process:function(n){for(var e=n.target||n.srcElement;e&&1!=e.nodeType;)e=e.parentNode;var g=e,a=n.type,h=p[a]||(p[a]=RegExp("(?:^|,)"+a+"(?:,|$)"));if(!h.test(o(e,"mx-ie"))){for(var l="mx-"+a,k,d,c=[];g&&g!=m&&!(k=o(g,l),d=o(g,"mx-ie"),k||h.test(d));)c.push(g),
g=g.parentNode;if(k){a=o(g,"mx-owner");if(!a){h=g;for(d=r.all();h&&h!=m;)if(v(d,h.id)){o(g,"mx-owner",a=h.id);break}else h=h.parentNode}if(a)(a=(a=r.get(a))&&a.view)&&a.processEvent({info:k,se:n,tId:e.id||(e.id="mx-e-"+u--),cId:g.id||(g.id="mx-e-"+u--)});else throw Error("miss mx-owner:"+k);}else for(;c.length;)n=c.shift(),d=o(n,"mx-ie"),h.test(d)||(d=d?d+","+a:a,o(n,"mx-ie",d))}},on:function(a,e){var g=this;q[a]?q[a]++:(r=e,q[a]=1,h[a]?g.unbubble(0,m,a):m["on"+a]=function(a){(a=a||window.event)&&
g.process(a)})},un:function(a){var e=q[a];0<e&&(e--,e||(h[a]?this.unbubble(1,m,a):m["on"+a]=null),q[a]=e)}};s.unbubble=function(a,e,g){(a?t.undelegate:t.delegate).call(t,e,g,"[mx-"+g+"]",s.process)};return s},{requires:["magix/magix","event","sizzle"]});
KISSY.add("magix/event",function(j,a){var t=a.safeExec;return{fire:function(a,h,m,q){var p="~"+a,j=this[p];if(j){h||(h={});if(!h.type)h.type=a;for(var a=j.length,o=a-1,r,s;a--;){r=q?a:o-a;s=j[r];if(s.d||s.r)j.splice(r,1),o--;s.d||t(s.f,h,this)}}m&&delete this[p]},on:function(j,h,m){j="~"+j;j=this[j]||(this[j]=[]);a.isNumeric(m)?j.splice(m,0,{f:h}):j.push({f:h,r:m})},un:function(a,h){var m="~"+a,j=this[m];if(j)if(h)for(var m=j.length-1,p;0<=m;m--){if(p=j[m],p.f==h&&!p.d){p.d=1;break}}else delete this[m]}}},
{requires:["magix/magix"]});
KISSY.add("magix/magix",function(j){var a=[].slice,t=/\/\.\/|\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,v=/\/[^\/]*$/,h=/[#?].*$/,m=/([^=&?\/#]+)=([^&=#?]*)/g,q=/^https?:\/\//i,p={},u=0,o={debug:false,iniFile:"app/ini",appName:"app",appHome:"./",tagName:"vframe",rootId:"magix_vf_root"},r=p.hasOwnProperty,s=function(c){return function(a,f,b){switch(arguments.length){case 0:b=c;break;case 1:b=d.isObject(a)?w(c,a):g(c,a)?c[a]:null;break;case 2:null===f?(delete c[a],b=f):c[a]=b=f}return b}},n=function(c){this.c=
[];this.x=c||20;this.b=this.x+5},e=function(c){return new n(c)},g=function(c,a){return c?r.call(c,a):0},w=function(c,a,f){for(var b in a)if(!f||!g(f,b))c[b]=a[b];return c};w(n.prototype,{get:function(c){var a=this.c,f,c="pathname"+c;if(g(a,c)&&(f=a[c],1<=f.f))f.f++,f.t=u++,f=f.v;return f},set:function(c,a){var f=this.c,c="pathname"+c,b=f[c];if(!g(f,c)){if(f.length>=this.b){f.sort(function(b,c){return c.f==b.f?c.t-b.t:c.f-b.f});for(var i=this.b-this.x;i--;)b=f.pop(),delete f[b.k]}b={};f.push(b);f[c]=
b}b.k=c;b.v=a;b.f=1;b.t=u++;return b},del:function(c){var c="pathname"+c,a=this.c,f=a[c];if(f)f.f=-1E5,f.v="",delete a[c]},has:function(c){return g(this.c,"pathname"+c)}});var x=e(60),l=e(),k=function(c,a,f,b,i,y){d.isArray(c)||(c=[c]);if(!a||!d.isArray(a)&&!a.callee)a=[a];for(b=0;b<c.length;b++)try{y=c[b],i=d.isFunction(y)&&y.apply(f,a)}catch(l){}return i},d={isNumeric:function(c){return!isNaN(parseFloat(c))&&isFinite(c)},mix:w,has:g,safeExec:k,noop:function(){},config:s(o),start:function(c){var a=
this,c=w(o,c);a.libEnv(c);a.libRequire(c.iniFile,function(f){o=w(c,f,c);var b=c.progress;a.libRequire(["magix/router","magix/vom"],function(i,f){i.on("!ul",f.locChged);i.on("changed",f.locChged);b&&f.on("progress",b);a.libRequire(c.extensions,i.start)})});c.ready&&(k(c.ready),delete c.ready)},keys:Object.keys||function(c){var a=[],f;for(f in c)g(c,f)&&a.push(f);return a},local:s({}),path:function(c,a){var f=c+"\n"+a,b=l.get(f);if(!b){q.test(a)?b=a:(c=c.replace(h,"").replace(v,"")+"/","/"==a.charAt(0)?
(b=q.test(c)?8:0,b=c.indexOf("/",b),b=c.substring(0,b)+a):b=c+a);for(;t.test(b);)b=b.replace(t,"$1/");l.set(f,b)}return b},pathToObject:function(c,a){var f=x.get(c);if(!f){var f={},b={},i="";h.test(c)?i=c.replace(h,""):~c.indexOf("=")||(i=c);if(i&&q.test(i))var d=i.indexOf("/",8),i=-1==d?"/":i.substring(d);c.replace(m,function(c,f,i){if(a)try{i=decodeURIComponent(i)}catch(d){}b[f]=i});f.pathname=i;f.params=b;x.set(c,f)}return f},objectToPath:function(c,a){var f=c.pathname,b=[],i=c.params,d,l;for(l in i)d=
i[l],a&&encodeURIComponent(d),b.push(l+"="+d);return f+(f&&b.length?"?":"")+b.join("&")},tmpl:function(a,d){return 1==arguments.length?{v:p[a],h:g(p,a)}:p[a]=d},listToMap:function(a,d){var f,b,i={},l;this.isString(a)&&(a=a.split(","));if(a&&(l=a.length))for(f=0;f<l;f++)b=a[f],i[d?b[d]:b]=d?b:1;return i},createCache:e};return w(d,{libRequire:function(c,d){c?j.use(c.toString(),function(c){d&&d.apply(c,a.call(arguments,1))}):d&&d()},libEnv:function(a){var d=a.appHome,f=location,b=a.appName,d=this.path(f.href,
d+"/");a.appHome=d;var i=a.debug;i&&(i=0==d.indexOf(f.protocol+"//"+f.host+"/"));f="";(f=i?j.now():a.appTag)&&(f+=".js");j.config({packages:[{name:b,path:d,debug:a.debug=i,combine:a.appCombine,tag:f}]})},isArray:j.isArray,isFunction:j.isFunction,isObject:j.isObject,isRegExp:j.isRegExp,isString:j.isString,isNumber:j.isNumber})});
KISSY.add("magix/router",function(j,a,t,v){var h=window,m=a.has,q=a.mix,p=document,u=/^UTF-8$/i.test(p.charset||p.characterSet||"UTF-8"),o=a.config(),r=a.createCache(),s=a.createCache(),n,e,g,w=65536,x=/#.*$/,l=/^[^#]*#?!?/,k=o.nativeHistory,d,c,A=function(b,c,d){if(b){d=this.params;a.isArray(b)||(b=b.split(","));for(var i=0;i<b.length&&!(c=m(d,b[i]));i++);}return c},f=function(){return m(this,"pathname")},b=function(){return m(this,"view")},i=function(){return this.hash.pathname!=this.query.pathname},
y=function(b){return this.hash.params[b]!=this.query.params[b]},C=function(b){return m(this.hash.params,b)},D=function(b){return m(this.query.params,b)},E=function(b){return this.params[b]},B=function(b){var b=a.pathToObject(b,u),d=b.pathname;d&&c&&(b.pathname=a.path(h.location.pathname,d));return b},z=q({getView:function(b){if(!g){g={rs:o.routes||{},nf:o.notFoundView};var c=o.defaultView;if(!c)throw Error("unset defaultView");g.home=c;var d=o.defaultPathname||"";g.rs[d]=c;g.pathname=d}b||(b=g.pathname);
c=g.rs;c=a.isFunction(c)?c.call(o,b):c[b];return{view:c?c:g.nf||g.home,pathname:c?b:g.nf?b:g.pathname}},start:function(){var b=z,a=h.history;d=k&&a.pushState;c=k&&!d;d?b.useState():b.useHash();b.route()},parseQH:function(b){var b=b||h.location.href,a=z,c=r.get(b);if(!c){var c=b.replace(x,""),d=b.replace(l,""),f=B(c),e=B(d),g={};q(g,f.params);q(g,e.params);c={pathnameDiff:i,paramDiff:y,hashOwn:C,queryOwn:D,get:E,href:b,srcQuery:c,srcHash:d,query:f,hash:e,params:g};r.set(b,c)}c.view||(b=a.getView(k?
c.hash.pathname||c.query.pathname:c.hash.pathname),q(c,b));return c},getChged:function(a,c){var d=c.href,i=a.href+"\n"+d,l=s.get(i);l||(i=d+"\n"+i,l=s.get(i));if(!l){var e,l={params:{}};if(a.pathname!=c.pathname)e=l.pathname=1;if(a.view!=c.view)e=l.view=1;var d=a.params,g=c.params,k;for(k in d)d[k]!=g[k]&&(e=1,l.params[k]=1);for(k in g)d[k]!=g[k]&&(e=1,l.params[k]=1);l.occur=e;l.isParam=A;l.isPathname=f;l.isView=b;s.set(i,l)}return l},route:function(){var b=z,a=b.parseQH(),c=e||{params:{},href:"~"},
d=!e;e=a;c=b.getChged(c,a);c.occur&&(n=a,b.fire("changed",{location:a,changed:c,force:d}))},navigate:function(b,i){var f=z;!i&&a.isObject(b)&&(i=b,b="");i&&(b=a.objectToPath({params:i,pathname:b},u));if(b){var l=B(b),e={};e.params=q({},l.params);e.pathname=l.pathname;if(e.pathname){if(c&&(l=n.query)&&(l=l.params))for(var k in l)m(l,k)&&!m(e.params,k)&&(e.params[k]="")}else k=q({},n.params),e.params=q(k,e.params),e.pathname=n.pathname;k=a.objectToPath(e);if(d?k!=n.srcQuery:k!=n.srcHash)d?(f.poped=
1,history.pushState(w--,p.title,k),f.route()):(q(e,n,e),e.srcHash=k,e.hash={params:e.params,pathname:e.pathname},f.fire("!ul",{loc:n=e}),location.hash="#!"+k)}}},t);z.useState=function(){var b=z,a=location.href;v.on(h,"popstate",function(){var c=location.href==a;if(b.poped||!c)b.poped=1,b.route()})};z.useHash=function(){v.on(h,"hashchange",z.route)};return z},{requires:["magix/magix","magix/event","event"]});
KISSY.add("magix/vframe",function(j,a,t,v){var h=document,m=65536,q=window.CollectGarbage||a.noop,p=a.mix,j=a.config(),u=j.tagName,o=j.rootId,r=a.has,s,n,e=function(a){return"object"==typeof a?a:h.getElementById(a)};h.createElement(u);var g=/<script[^>]*>[\s\S]*?<\/script>/ig,w,x=function(a){this.id=a;this.cM={};this.rC=this.cC=0;this.sign=-2147483648;this.rM={}};p(x,{root:function(a,k){if(!s){w=k;var d=e(o);if(!d)d=h.createElement(u),d.id=o,h.body.insertBefore(d,h.body.firstChild);s=new x(o);a.add(s)}return s}});
p(p(x.prototype,t),{mountView:function(l,k){var d=this,c=e(d.id);c._bak?c._chgd=1:(c._bak=1,c._tmpl=c.innerHTML.replace(g,""));d.unmountView();if(l){var h=a.pathToObject(l),f=h.pathname,b=--d.sign;a.libRequire(f,function(a){if(b==d.sign){var l=d.owner;v.prepare(a);var g=new a({owner:d,id:d.id,$:e,path:f,vom:l,location:w});d.view=g;g.on("interact",function(b){if(!b.tmpl){if(c._chgd)c.innerHTML=c._tmpl;d.mountZoneVframes(0,0,1)}g.on("rendered",function(){d.mountZoneVframes(0,0,1)});g.on("prerender",
function(){d.unmountZoneVframes()});g.on("inited",function(){d.viewInited=1;d.fire("viewInited",{view:g})})},0);k=k||{};g.load(p(k,h.params,k))}})}},unmountView:function(){if(this.view){n||(n={caused:this.id});this.unmountZoneVframes();this.cAlter(n);this.view.destroy();var a=e(this.id);if(a&&a._bak)a.innerHTML=a._tmpl;delete this.view;delete this.viewInited;n=0;this.fire("viewUnmounted");q()}this.un("viewInited");this.sign--},mountVframe:function(a,e,d,c){var g=this.owner,f=g.get(a);if(!f)f=new x(a),
f.pId=this.id,r(this.cM,a)||this.cC++,this.cM[a]=c,g.add(f);f.mountView(e,d);return f},mountZoneVframes:function(a,k,d){this.unmountZoneVframes(a);var a=e(a||this.id).getElementsByTagName(u),c=a.length,g={};if(c)for(var f=0,b,i,y,h;f<c;f++){b=a[f];i=b.id||(b.id="magix_vf_"+m--);r(g,i)||(y=b.getAttribute("mx-view"),h=b.getAttribute("mx-defer"),(!h||y)&&this.mountVframe(i,y,k,d));b=e(b).getElementsByTagName(u);i=0;for(y=b.length;i<y;i++)g[b[i].id||(b[i].id="magix_vf_"+m--)]=1}this.cC==this.rC&&this.cCreated({})},
unmountVframe:function(a){var a=a||this.id,e=this.owner,d=e.get(a);if(d){var c=d.fcc;d.unmountView();e.remove(a,c);if((e=e.get(d.pId))&&r(e.cM,a))delete e.cM[a],e.cC--}},unmountZoneVframes:function(a){if(a){for(var a=e(a).getElementsByTagName(u),g={},d=this.cM,c=a.length-1,h;0<=c;c--)h=a[c].id,r(d,h)&&(g[h]=1);a=g}else a=this.cM;for(var f in a)this.unmountVframe(f)},cCreated:function(a){var e=this.view;if(e&&!this.fcc)this.fcc=1,delete this.fca,e.fire("created",a),this.fire("created",a);var d=this.owner;
d.vfCreated();e=this.id;if((d=d.get(this.pId))&&!r(d.rM,e))d.rM[e]=d.cM[e],d.rC++,d.rC==d.cC&&d.cCreated(a)},cAlter:function(a){delete this.fcc;if(!this.fca){var e=this.view,d=this.id;if(e)this.fca=1,e.fire("alter",a),this.fire("alter",a);if((e=this.owner.get(this.pId))&&r(e.rM,d)){var c=e.rM[d];e.rC--;delete e.rM[d];c&&e.cAlter(a)}}},locChged:function(e,g){var d=this.view;if(d&&d.sign&&d.rendered){var c=d.olChanged(g),h={location:e,changed:g,prevent:function(){this.cs=[]},toChildren:function(b){b=
b||[];a.isString(b)&&(b=b.split(","));this.cs=b}};c&&a.safeExec(d.locationChange,h,d);for(var d=h.cs||a.keys(this.cM),c=0,h=d.length,f=this.owner,b;c<h;c++)(b=f.get(d[c]))&&b.locChged(e,g)}}});return x},{requires:["magix/magix","magix/event","magix/view"]});
KISSY.add("magix/view",function(j,a,t,v,h){var m=a.safeExec,q=a.has,p=[],u=a.config(),o=a.mix,r=a.listToMap("render,renderUI"),s=function(b){return function(){var a;this.sign&&(this.sign++,this.fire("rendercall"),a=b.apply(this,arguments));return a}},n=function(b){o(this,b);this.sign=1};o(n,{wrapAsyn:function(){if(!this["~"]){this["~"]=1;var b=this.prototype,c,d;for(d in r)c=b[d],a.isFunction(c)&&c!=a.noop&&(b[d]=s(c))}}});var e=n.prototype,g=window.CollectGarbage||a.noop,w=/<[a-z]+(?:[^">]|"[^"]*")+(?=>)/g,
x=/\smx-owner\s*=/,l=/\smx-[^v][a-z]+\s*=/,k=function(b){return!x.test(b)&&l.test(b)?b+' mx-owner="'+k.t+'"':b},d={prevent:function(b){b=b||this.domEvent;b.preventDefault?b.preventDefault():b.returnValue=!1},stop:function(b){b=b||this.domEvent;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},halt:function(b){this.prevent(b);this.stop(b)}},c=/(\w+)(?:<(\w+)>)?(?:{([\s\S]*)})?/,A=/(\w+):([^,]+)/g;o(e,t);o(e,{render:a.noop,locationChange:a.noop,init:a.noop,hasTmpl:!0,enableEvent:!0,load:function(){var b=
this,a=b.hasTmpl,c=arguments,d=b.sign,e=q(b,"template"),f=function(f){if(d==b.sign){if(!e)b.template=b.wrapMxEvent(f);b.delegateEvents();b.fire("interact",{tmpl:a},1);m(b.init,c,b);b.fire("inited",0,1);m(b.render,p,b);if(!a&&!b.rendered)b.rendered=!0,b.fire("primed",null,1)}};a&&!e?b.fetchTmpl(f):f()},beginUpdateHTML:function(){this.sign&&this.rendered&&(this.fire("refresh",0,1),this.fire("prerender"))},endUpdateHTML:function(){if(this.sign)this.rendered||this.fire("primed",0,1),this.rendered=!0,
this.fire("rendered"),g()},wrapMxEvent:function(b){k.t=this.id;return(""+b).replace(w,k)},setViewHTML:function(b){this.beginUpdateHTML();if(this.sign)this.$(this.id).innerHTML=b;this.endUpdateHTML()},observeLocation:function(b){var c;if(!this.$ol)this.$ol={keys:[]};c=this.$ol;var d=c.keys;if(a.isObject(b))c.pn=b.pathname,b=b.keys;if(b)c.keys=d.concat(a.isString(b)?b.split(","):b)},olChanged:function(b){var a=this.$ol;if(a){var c=0;a.pn&&(c=b.isPathname());c||(c=b.isParam(a.keys));return c}return 1},
destroy:function(){this.fire("refresh",0,1);this.fire("destroy",0,1,1);this.delegateEvents(1);this.sign=0},parentView:function(){var a=this.vom.get(this.owner.pId),c=null;if(a&&a.viewInited)c=a.view;return c},processEvent:function(a){if(this.enableEvent&&this.sign){var e=a.se,f=a.info.match(c),g=f[1],h=f[2],f=f[3],k=this.events;if(k){var j=k[e.type];(h=d[h])&&h.call(d,e);if(j&&j[g]){var l={};f&&f.replace(A,function(a,b,c){l[b]=c});m(j[g],o({view:this,currentId:a.cId,targetId:a.tId,domEvent:e,events:k,
params:l},d),j)}}}},delegateEvents:function(a){var c=this.events,a=a?v.un:v.on,d=this.vom,e;for(e in c)a.call(v,e,d)}});var f=function(a,c,d){for(var e in c)j.isObject(c[e])?(q(a,e)||(a[e]={}),f(a[e],c[e],1)):d&&(a[e]=c[e])};n.prototype.fetchTmpl=function(b){var c=this,d=c.template;if(j.isUndefined(d))if(d=a.tmpl(c.path),d.h)b(d.v);else{var e=u.appHome+c.path+".html",g=f[e],d=function(d){b(a.tmpl(c.path,d))};g?g.push(d):(g=f[e]=[d],h({url:e+(u.debug?"?t="+j.now():""),success:function(a){m(g,a);delete f[e]},
error:function(a,b){m(g,b);delete f[e]}}))}else b(d)};n.extend=function(a,c){var d=function(){d.superclass.constructor.apply(this,arguments);c&&m(c,arguments,this)};d.extend=this.extend;return j.extend(d,this,a)};n.prepare=function(a){if(!a.wrapAsyn){a.wrapAsyn=this.wrapAsyn;a.extend=this.extend;for(var c=a.prototype,d=a.superclass;d;)d=d.constructor,f(c,d.prototype),d=d.superclass}a.wrapAsyn()};return n},{requires:["magix/magix","magix/event","magix/body","ajax"]});
KISSY.add("magix/vom",function(j,a,t,v){var h=t.has,m=t.mix,q=0,p=0,u=0,o=0,r={},s={},n=t.mix({all:function(){return r},add:function(a){if(!h(r,a.id))q++,r[a.id]=a,a.owner=n,n.fire("add",{vframe:a})},get:function(a){return r[a]},remove:function(a,g){var h=r[a];h&&(q--,g&&p--,delete r[a],n.fire("remove",{vframe:h}))},vfCreated:function(){if(!o){p++;var a=p/q;u<a&&n.fire("progress",{percent:u=a},o=1==a)}},root:function(){return a.root(n,s)},locChged:function(a){var g=a.loc,h;g?h=1:g=a.location;m(s,
g);if(!h)h=n.root(),a=a.changed,a.isView()?h.mountView(g.view):h.locChged(g,a)}},v);return n},{requires:["magix/vframe","magix/magix","magix/event"]});(function(j){var a=function(){};if(!j.console)j.console={log:a,info:a,error:a};var t,v={};if(!j.Magix)j.Magix={config:function(a){for(var j in a)v[j]=a[j]},start:function(a){t=a}},KISSY.use("magix/magix",function(a,m){j.Magix=m;m.config(v);t&&m.start(t)})})(this);